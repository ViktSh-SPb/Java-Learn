## 1Ô∏è‚É£ –ü–æ–¥–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —ç—Ç–∞–ø–µ –∑–∞–ø—Ä–æ—Å–∞ (Eager Fetch —á–µ—Ä–µ–∑ JOIN)
### üîπ 1. `JOIN FETCH` –≤ JPQL
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å **–≥–ª–∞–≤–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ª–µ–Ω–∏–≤—ã–µ –ø–æ–ª—è –≤ –æ–¥–Ω–æ–º SQL-–∑–∞–ø—Ä–æ—Å–µ**.
- –ü—Ä–∏–º–µ—Ä:
```java
@Query("SELECT a FROM Author a LEFT JOIN FETCH a.books")
List<Author> findAllWithBooks();
```
**–ü–ª—é—Å—ã:**
- –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ 1+N ‚Üí —Ä–µ—à–∞–µ—Ç N+1.
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–µ SQL-–∑–∞–ø—Ä–æ—Å—ã.
**–ú–∏–Ω—É—Å—ã:**
- –ú–æ–≥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –¥—É–±–ª–∏, –µ—Å–ª–∏ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–ª–ª–µ–∫—Ü–∏–π.
- –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –≤—ã–±–æ—Ä–æ–∫ –±–µ–∑ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏.
### üîπ 2. `@EntityGraph` (Spring Data / JPA)
- –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º, –∫–∞–∫–∏–µ —Å–≤—è–∑–∏ –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å:
```java
@EntityGraph(attributePaths = {"books"})
Optional<Author> findById(Long id);
```
**–ü–ª—é—Å—ã:**
- –ß–∏—Å—Ç—ã–π –∫–æ–¥, –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∏—Å–∞—Ç—å JPQL —Å JOIN FETCH.
- –ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å –º–µ—Ç–æ–¥–∞–º–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
**–ú–∏–Ω—É—Å—ã:**
- –ù–µ –≤—Å–µ–≥–¥–∞ —É–¥–æ–±–Ω–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö JOIN.
## 2Ô∏è‚É£ Batch Fetching (–ü–∞–∫–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π)
- Hibernate –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–µ–Ω–∏–≤—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**:
```java
@OneToMany(fetch = FetchType.LAZY)
@BatchSize(size = 10)
private List<Book> books;
```
- Hibernate –≤—ã–ø–æ–ª–Ω–∏—Ç –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è 10 –∫–æ–ª–ª–µ–∫—Ü–∏–π —Å—Ä–∞–∑—É, –≤–º–µ—Å—Ç–æ N –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
**–ü–ª—é—Å—ã:**
- –°–Ω–∏–∂–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö.
- –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è JPQL.
**–ú–∏–Ω—É—Å—ã:**
- –ù–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Äî —Ç–æ–ª—å–∫–æ —É–º–µ–Ω—å—à–∞–µ—Ç N.
- –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –Ω—É–∂–Ω–æ –ø–æ–¥–±–∏—Ä–∞—Ç—å –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫—É.
## 3Ô∏è‚É£ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DTO –∏ –ø—Ä–æ–µ–∫—Ü–∏–π
- –í–º–µ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å—É—â–Ω–æ—Å—Ç–µ–π, —Å—Ç—Ä–æ–∏–º **DTO —Å –Ω—É–∂–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ —á–µ—Ä–µ–∑ JOIN**:
```java
@Query("SELECT new com.example.dto.AuthorDto(a.name, b.title) FROM Author a LEFT JOIN a.books b")
List<AuthorDto> findAllAuthorDtos();
```
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **interface-based projections** –≤ Spring Data JPA.
**–ü–ª—é—Å—ã:**
- –ù–∏–∫–∞–∫–∏—Ö –ª–µ–Ω–∏–≤—ã—Ö –ø—Ä–æ–∫—Å–∏ ‚Üí N+1 –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç.
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ –∏ SQL.
**–ú–∏–Ω—É—Å—ã:**
- –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—É—â–Ω–æ—Å—Ç—å, –∞ DTO ‚Üí –Ω–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å –±–∞–∑–æ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –Ω–∞–ø—Ä—è–º—É—é.
- –ù—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ DTO-–∫–ª–∞—Å—Å—ã.
## 4Ô∏è‚É£ –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π `@Transactional` + `Hibernate.initialize()`
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å LAZY, –º–æ–∂–Ω–æ **–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**:
```java
@Transactional
public Author getAuthorWithBooks(Long id) {
    Author author = authorRepository.findById(id).orElseThrow();
    Hibernate.initialize(author.getBooks()); // –ø–æ–¥–≥—Ä—É–∂–∞–µ–º –ª–µ–Ω–∏–≤–æ–µ –ø–æ–ª–µ
    return author;
}
```
**–ü–ª—é—Å—ã:**
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å LAZY-–ø–æ–ª—è–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ.
**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–µ—Ä–∂–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –æ—Ç–∫—Ä—ã—Ç–æ–π.
- –ù–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –Ω–∞ —É—Ä–æ–≤–Ω–µ SQL ‚Äî –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å N –∑–∞–ø—Ä–æ—Å–æ–≤.
## 5Ô∏è‚É£ Open Session In View (OSIV) ‚Äî Legacy –ø–æ–¥—Ö–æ–¥
- –î–µ—Ä–∂–∏—Ç Hibernate-—Å–µ—Å—Å–∏—é –æ—Ç–∫—Ä—ã—Ç–æ–π –¥–æ –∫–æ–Ω—Ü–∞ –∑–∞–ø—Ä–æ—Å–∞ (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä/—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON).
- –õ–µ–≥–∫–æ —Ä–µ—à–∞–µ—Ç LazyInitializationException, –Ω–æ:
**–ú–∏–Ω—É—Å—ã:**
- N+1 –≤—Å–µ –µ—â–µ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å.
- –ù–∞—Ä—É—à–∞–µ—Ç —Å–ª–æ–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –º–æ–∂–µ—Ç –¥–µ—Ä–∂–∞—Ç—å –¥–æ–ª–≥–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö MVC-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, **–Ω–µ –¥–ª—è REST API**.
## ‚úÖ –ò—Ç–æ–≥: –±–∞–∑–æ–≤—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ —Ä–µ—à–µ–Ω–∏—é N+1

|–ü–æ–¥—Ö–æ–¥|–°—É—Ç—å|–ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å|
|---|---|---|
|**JOIN FETCH**|JPQL —Å JOIN ‚Üí –æ–¥–∏–Ω SQL|–ß—ë—Ç–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã, –º–∞–ª–µ–Ω—å–∫–∏–µ –≤—ã–±–æ—Ä–∫–∏|
|**@EntityGraph**|–î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ –ø–æ–¥–≥—Ä—É–∂–∞–µ–º —Å–≤—è–∑–∏|Spring Data —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, —á–∏—Ç–∞–µ–º–æ—Å—Ç—å|
|**Batch Fetching**|–ü–æ–¥–≥—Ä—É–∑–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π –ø–∞–∫–µ—Ç–∞–º–∏|–ë–æ–ª—å—à–∏–µ –≤—ã–±–æ—Ä–∫–∏, LAZY –ø–æ–ª—è|
|**DTO / –ø—Ä–æ–µ–∫—Ü–∏–∏**|–í—ã–±–æ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã—Ö –ø–æ–ª–µ–π|REST API, —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ –∏ SQL|
|**Transactional + Hibernate.initialize()**|–Ø–≤–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è LAZY|–ö–æ–≥–¥–∞ –Ω–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∏–ª–∏ —Å–≤—è–∑–∏|
|**OSIV**|–î–µ—Ä–∂–∏–º —Å–µ—Å—Å–∏—é –æ—Ç–∫—Ä—ã—Ç–æ–π –¥–æ –∫–æ–Ω—Ü–∞ –∑–∞–ø—Ä–æ—Å–∞|Legacy MVC-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è|
