
**Транзакция** — это  набор последовательных операций с базой данных, соединенных в одну логическую единицу.

## Виды транзакций

Транзакции делят на два вида:

**Неявные транзакции,** которые предусмотрены на уровне базы данных. Например, БД задает отдельную инструкцию INSERT, UPDATE или DELETE как единицу транзакции.

**Явные транзакции** — их начало и конец явно обозначаются такими инструкциями, как BEGIN TRANSACTION, COMMIT или ROLLBACK.



**Atomicity или атомарность (A)**
неделимость: либо будут выполнены все действия транзакции, либо никакие

**Consistency или согласованность (C)**
если до выполнения транзакции данные в БД находятся в неком состоянии «good state»*, то они будут в этом же состоянии и после выполнения транзакции

**Isolation или изоляция (I)**
позволяет скрывать изменения, внесенные одной операцией транзакции при возникновении явления race condition

- **Эффект потерянного обновления** возникает, когда несколько транзакций обновляют одни и те же данные, не учитывая изменений, сделанных другими транзакциями.- 
- **Эффект грязного чтения** возникает, когда транзакция считывает данные, которые еще не были зафиксированы.
- **Эффект неповторяемого чтения** возникает, когда транзакция считывает дважды одну и ту же строку, но каждый раз получает разные результаты.
- **Эффект чтения фантомов** возникает, когда набор данных соответствует условиям поиска, но изначально не отображается.


---

- **Read uncommitted** – это уровень изоляции, при котором каждая транзакция видит незафиксированные изменения другой транзакции. Справляется с эффектом потерянного обновления, но остаются остальные проблемы: эффекты грязного чтения, неповторяемого чтения, чтения фантомов.
![[Pasted image 20250421195012.png]]
- **Read committed** — это уровень изоляции, при котором параллельно исполняющиеся транзакции видят только зафиксированные изменения других транзакций. Справляется с эффектами потерянного обновления и грязного чтения, остаются эффекты неповторяемого чтения и чтения фантомов.
 ![[Pasted image 20250421195008.png]]
-  **Repeatable read** или snapshot isolation — это уровень изоляции, при котором транзакция не видит изменения данных, прочитанные ей ранее, однако способна прочитать новые данные, соответствующие условию поиска. Справляется с эффектами потерянного обновления, грязного чтения, неповторяемого чтения, остается эффект чтения фантомов.
 ![[Pasted image 20250421195003.png]]
- **Serializable** — это уровень изоляции, при котором каждая транзакция выполняется так, как будто параллельных транзакций не существует. Справляется со всеми перечисленными выше эффектами.
 ![[Pasted image 20250421194938.png]]
**Durability или долговечность (D)**
если транзакция выполнена, и даже если в следующий момент произойдет сбой в системе, результат сохранится