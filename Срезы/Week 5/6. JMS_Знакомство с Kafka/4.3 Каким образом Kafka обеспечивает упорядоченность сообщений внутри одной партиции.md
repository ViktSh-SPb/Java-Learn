## 1Ô∏è‚É£ –ü–∞—Ä—Ç–∏—Ü–∏—è –∫–∞–∫ –µ–¥–∏–Ω–∏—Ü–∞ —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ—Å—Ç–∏
- –ö–∞–∂–¥—ã–π **—Ç–æ–ø–∏–∫** –¥–µ–ª–∏—Ç—Å—è –Ω–∞ **–ø–∞—Ä—Ç–∏—Ü–∏–∏ (partitions)**.
- **–ü–æ—Ä—è–¥–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏**, –∞ –Ω–µ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏.
üìå _–ò–¥–µ—è_: –ø–∞—Ä—Ç–∏—Ü–∏—è ‚Äî —ç—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤ **append-only –∂—É—Ä–Ω–∞–ª**.
- –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π **offset** ‚Äî —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, —É–∫–∞–∑—ã–≤–∞—é—â–µ–µ –µ–≥–æ –ø–æ–∑–∏—Ü–∏—é –≤ –ª–æ–≥–µ.
- –°–æ–æ–±—â–µ–Ω–∏—è —á–∏—Ç–∞—é—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ **–≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è offset**.
## 2Ô∏è‚É£ –ö–∞–∫ Producer –≤—ã–±–∏—Ä–∞–µ—Ç partition
–ü–æ—Ä—è–¥–æ–∫ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –ø—Ä–æ–¥—é—Å–µ—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ partition:

|–°—Ü–µ–Ω–∞—Ä–∏–π|–ü–æ—Ä—è–¥–æ–∫ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω?|
|---|---|
|–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–¥—É—Ç –≤ **–æ–¥–Ω—É –ø–∞—Ä—Ç–∏—Ü–∏—é**|‚úÖ –î–∞, –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è|
|–°–æ–æ–±—â–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è **–ø–æ —Ä–∞–∑–Ω—ã–º –ø–∞—Ä—Ç–∏—Ü–∏—è–º**|‚ùå –ù–µ—Ç, –ø–æ—Ä—è–¥–æ–∫ –º–µ–∂–¥—É –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω|
|–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ (key)|‚úÖ –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º –ø–æ–ø–∞–¥–∞—é—Ç –≤ –æ–¥–Ω—É –ø–∞—Ä—Ç–∏—Ü–∏—é, –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è —ç—Ç–æ–≥–æ –∫–ª—é—á–∞|

üìå _–ü—Ä–∏–º–µ—Ä:_
```java
ProducerRecord<String, String> record = new ProducerRecord<>("orders", "user123", "OrderCreated");
producer.send(record);
```
–í—Å–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è `user123` –ø–æ–ø–∞–¥—É—Ç –≤ –æ–¥–Ω—É –ø–∞—Ä—Ç–∏—Ü–∏—é ‚Üí –ø–æ—Ä—è–¥–æ–∫ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω.
## 3Ô∏è‚É£ –ó–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–∞—Ä—Ç–∏—Ü–∏—é
1. Producer –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí Leader partition.
2. Kafka **–¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–æ–Ω–µ—Ü –ª–æ–≥–∞** (append-only).
3. –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π **offset**:
    ```
    Offset 0 ‚Üí "Order1"
    Offset 1 ‚Üí "Order2"
    Offset 2 ‚Üí "Order3"
    ```
4. Consumer —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è **–ø–æ offset –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è**.
## 4Ô∏è‚É£ –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –∏ –ø–æ—Ä—è–¥–æ–∫
- –†–µ–ø–ª–∏–∫–∞—Ü–∏—è **–Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç –ø–æ—Ä—è–¥–æ–∫**: followers –ø–æ–ª—É—á–∞—é—Ç –∫–æ–ø–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ, —á—Ç–æ –∏ –ª–∏–¥–µ—Ä.
- –î–∞–∂–µ –ø—Ä–∏ failover (—Å–º–µ–Ω–µ –ª–∏–¥–µ—Ä–∞) Kafka –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –Ω–æ–≤—ã–π –ª–∏–¥–µ—Ä –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ª–æ–≥–∏–∫—É append-only –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π.
## 5Ô∏è‚É£ –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –∏ –ø–æ—Ä—è–¥–æ–∫
- **Consumer** —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –ø–∞—Ä—Ç–∏—Ü–∏–∏ **–ø–æ –ø–æ—Ä—è–¥–∫—É offset**.
- –í **consumer group** –∫–∞–∂–¥–∞—è –ø–∞—Ä—Ç–∏—Ü–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –æ–¥–Ω–∏–º consumer**, –ø–æ—ç—Ç–æ–º—É –ø–æ—Ä—è–¥–æ–∫ –≤–Ω—É—Ç—Ä–∏ –ø–∞—Ä—Ç–∏—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.
üìå _–í–∞–∂–Ω–æ:_ –µ—Å–ª–∏ –æ–¥–∏–Ω consumer –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä—Ç–∏—Ü–∏–π, –ø–æ—Ä—è–¥–æ–∫ **–º–µ–∂–¥—É –Ω–∏–º–∏ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è**.
## 6Ô∏è‚É£ –ò—Ç–æ–≥
- **–ü–æ—Ä—è–¥–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏.**
- –ú–µ—Ö–∞–Ω–∏–∑–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –ø–æ—Ä—è–¥–æ–∫:
    1. **append-only –ª–æ–≥** –Ω–∞ –¥–∏—Å–∫–µ;
    2. **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π offset** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è;
    3. **–∫–∞–∂–¥–∞—è –ø–∞—Ä—Ç–∏—Ü–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è –æ–¥–Ω–∏–º –ª–∏–¥–µ—Ä–æ–º**;
    4. **consumer group** –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –ø–∞—Ä—Ç–∏—Ü–∏—é —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–º—É consumer.
- –î–ª—è —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏—è –ø–æ –∫–ª—é—á—É –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **key-based partitioning**, —á—Ç–æ–±—ã –≤—Å–µ —Å–æ–±—ã—Ç–∏—è —Å –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º –ø–æ–ø–∞–¥–∞–ª–∏ –≤ –æ–¥–Ω—É –ø–∞—Ä—Ç–∏—Ü–∏—é.