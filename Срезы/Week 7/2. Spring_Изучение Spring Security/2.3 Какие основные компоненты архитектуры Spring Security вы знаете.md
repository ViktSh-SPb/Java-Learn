–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ **Spring Security** —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–∞–±–æ—Ä–∞ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏ –∑–∞—â–∏—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤. –ù–∏–∂–µ ‚Äî —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ —á–∞—Å—Ç–∏ —Å –∫—Ä–∞—Ç–∫–∏–º–∏ –∏ –ø–æ–Ω—è—Ç–Ω—ã–º–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏.
# üîë **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Spring Security**
## 1. **Security Filter Chain (—Ü–µ–ø–æ—á–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)**
–≠—Ç–æ —Å–µ—Ä–¥—Ü–µ Spring Security.  
–ö–∞–∂–¥—ã–π HTTP-–∑–∞–ø—Ä–æ—Å –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Å–µ—Ä–∏—é —Ñ–∏–ª—å—Ç—Ä–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä:
- `UsernamePasswordAuthenticationFilter`
- `BearerTokenAuthenticationFilter`
- `SecurityContextHolderFilter`
- `ExceptionTranslationFilter`
- `AuthorizationFilter`
–§–∏–ª—å—Ç—Ä—ã:
- –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ç–æ–∫–µ–Ω—ã,
- —Å–æ–∑–¥–∞—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é,
- –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞,
- —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –æ—Ç–≤–µ—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö.
üëâ –≠—Ç–æ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.
## 2. **SecurityContext –∏ SecurityContextHolder**
`SecurityContext` —Ö—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–µ–≥–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
`SecurityContextHolder` ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –æ—Ç–∫—É–¥–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ:
```java
Authentication auth = SecurityContextHolder.getContext().getAuthentication();
```
## 3. **Authentication**
–û–±—ä–µ–∫—Ç, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
–°–æ–¥–µ—Ä–∂–∏—Ç:
- –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,
- —Ä–æ–ª–∏/–ø—Ä–∞–≤–∞,
- –¥–∞–Ω–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Ç–æ–∫–µ–Ω, –ø–∞—Ä–æ–ª—å),
- –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏.
–ü—Ä–∏–º–µ—Ä JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
```java
UsernamePasswordAuthenticationToken
```
## 4. **AuthenticationManager**
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π **–ø—Ä–æ–≤–æ–¥–∏—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é**.
–ï–≥–æ –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –∏–ª–∏ —Ç–æ–∫–µ–Ω.
–û–±—ã—á–Ω–æ –æ–¥–∏–Ω –≥–ª–∞–≤–Ω—ã–π:
```java
ProviderManager
```
## 5. **AuthenticationProvider**
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ç–∏–ø—É –¥–∞–Ω–Ω—ã—Ö.
–ü—Ä–∏–º–µ—Ä—ã:
- `DaoAuthenticationProvider` ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –ë–î
- `JwtAuthenticationProvider` ‚Äî –∫–∞—Å—Ç–æ–º–Ω—ã–π JWT
- `LdapAuthenticationProvider` ‚Äî LDAP
## 6. **UserDetailsService**
–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **–∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö**.
–ù–∞–ø—Ä–∏–º–µ—Ä:
- –ë–î
- LDAP
- In-memory
–ú–µ—Ç–æ–¥:
```java
UserDetails loadUserByUsername(String username)
```
## 7. **UserDetails**
–û–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- –ª–æ–≥–∏–Ω
- –ø–∞—Ä–æ–ª—å
- —Ä–æ–ª—å/–ø—Ä–∞–≤–æ
- —Å—Ç–∞—Ç—É—Å (enabled/locked‚Ä¶)
Spring –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `User` –∏–∑ –∫–æ—Ä–æ–±–∫–∏.
## 8. **PasswordEncoder**
–ö–æ–¥–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª–∏.
–°–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π:
```java
new BCryptPasswordEncoder();
```
## 9. **Authorization (AccessDecisionManager / Voters)**
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–∞—é—Ç ‚Äî –º–æ–∂–Ω–æ –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ.
–ù–∞–ø—Ä–∏–º–µ—Ä:
- –¥–æ—Å—Ç—É–ø –∫ URL
- –¥–æ—Å—Ç—É–ø –∫ –º–µ—Ç–æ–¥—É (`@PreAuthorize`)
- –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å—É
## 10. **Method Security (Pre/Post annotations)**
–ó–∞—â–∏—Ç–∞ –Ω–µ —Ç–æ–ª—å–∫–æ URL, –Ω–æ –∏ –º–µ—Ç–æ–¥–æ–≤.
–ù–∞–ø—Ä–∏–º–µ—Ä:
```java
@PreAuthorize("hasRole('ADMIN')")
public void doAdminStuff() {}
```
–í–∫–ª—é—á–∞–µ—Ç—Å—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–µ–π:
```java
@EnableMethodSecurity
```
## 11. **CsrfTokenRepository**
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç CSRF-–∞—Ç–∞–∫ (–∞–∫—Ç—É–∞–ª—å–Ω–æ –¥–ª—è —Ñ–æ—Ä–º).
## 12. **ExceptionTranslationFilter**
–ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è **AccessDenied** –∏ **AuthenticationException**  
–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ HTTP-–∫–æ–¥—ã (401, 403).
# üìå –ò—Ç–æ–≥: –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

|–ö–æ–º–ø–æ–Ω–µ–Ω—Ç|–ó–∞ —á—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç|
|---|---|
|**Security Filter Chain**|–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤|
|**AuthenticationManager / Providers**|–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è|
|**UserDetailsService**|–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è|
|**SecurityContextHolder**|–•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è|
|**Authorization**|–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤|
|**PasswordEncoder**|–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π|
|**Method Security**|–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–µ—Ç–æ–¥–æ–≤|
|**ExceptionTranslationFilter**|–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏|
