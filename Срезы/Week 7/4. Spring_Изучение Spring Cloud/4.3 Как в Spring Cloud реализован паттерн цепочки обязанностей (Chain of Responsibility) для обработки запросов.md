–í Spring Cloud **–ø–∞—Ç—Ç–µ—Ä–Ω ‚Äú–¶–µ–ø–æ—á–∫–∞ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π‚Äù (Chain of Responsibility)** —á–∞—â–µ –≤—Å–µ–≥–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è **–Ω–∞ —É—Ä–æ–≤–Ω–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã**, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ **Spring Cloud Gateway** –∏–ª–∏ —á–µ—Ä–µ–∑ **Spring Cloud Sleuth / —Ñ–∏–ª—å—Ç—Ä—ã**, –∞ –Ω–µ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π Java-–ø–∞—Ç—Ç–µ—Ä–Ω –≤ –∫–æ–¥–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞.
# üß© **1. –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è Chain of Responsibility**
- –ù–µ—Å–∫–æ–ª—å–∫–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (`Handler`) –ø–æ–ª—É—á–∞—é—Ç –∑–∞–ø—Ä–æ—Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- –ö–∞–∂–¥—ã–π –º–æ–∂–µ—Ç:
    - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é
    - —á–∞—Å—Ç–∏—á–Ω–æ
    - –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–ª—å—à–µ
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å –≥–∏–±–∫–∏–µ —Ü–µ–ø–æ—á–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏, –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏
–í –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —ç—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è:
- –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è / —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏
- rate limiting / throttling
- —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ / –æ—Ç–≤–µ—Ç–æ–≤
# üß© **2. Spring Cloud Gateway ‚Äì —Ñ–∏–ª—å—Ç—Ä—ã –∫–∞–∫ —Ü–µ–ø–æ—á–∫–∞**
Spring Cloud Gateway —Ä–µ–∞–ª–∏–∑—É–µ—Ç **Chain of Responsibility** —á–µ—Ä–µ–∑ **GlobalFilters** –∏ **Route Filters**.
- **GlobalFilter** ‚Äì –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
- **GatewayFilter** ‚Äì –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞
–ö–∞–∂–¥—ã–π —Ñ–∏–ª—å—Ç—Ä —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
```java
public interface GlobalFilter {
    Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain);
}
```
- `exchange` ‚Äì —Ç–µ–∫—É—â–∏–π HTTP-–∑–∞–ø—Ä–æ—Å/–æ—Ç–≤–µ—Ç
- `chain` ‚Äì —Å–ª–µ–¥—É—é—â–∞—è —Å—Å—ã–ª–∫–∞ –≤ —Ü–µ–ø–æ—á–∫–µ
–ü—Ä–∏–º–µ—Ä —Ñ–∏–ª—å—Ç—Ä–∞:
```java
@Component
public class LoggingFilter implements GlobalFilter {

    @Override
    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {
        System.out.println("Request path: " + exchange.getRequest().getPath());
        // –ü–µ—Ä–µ–¥–∞—Ç—å –∑–∞–ø—Ä–æ—Å –¥–∞–ª—å—à–µ –ø–æ —Ü–µ–ø–æ—á–∫–µ
        return chain.filter(exchange);
    }
}
```
–¶–µ–ø–æ—á–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:
```
GlobalFilter1 ‚Üí GlobalFilter2 ‚Üí RouteFilter1 ‚Üí RouteFilter2 ‚Üí Handler ‚Üí Response
```
- –ö–∞–∂–¥—ã–π —Ñ–∏–ª—å—Ç—Ä –º–æ–∂–µ—Ç:
    - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–∞–ª—å—à–µ (`chain.filter(exchange)`)
    - –ø—Ä–µ—Ä–≤–∞—Ç—å —Ü–µ–ø–æ—á–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ—Ä–Ω—É—Ç—å 401)
# üß© **3. –§–∏–ª—å—Ç—Ä—ã Spring Cloud Sleuth / Micrometer Tracing**
- Sleuth –≤–Ω–µ–¥—Ä—è–µ—Ç —Ü–µ–ø–æ—á–∫—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è **—Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏** HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
- –ö–∞–∂–¥—ã–π —Ñ–∏–ª—å—Ç—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç `traceId` –∏ `spanId` –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏.
- –¶–µ–ø–æ—á–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ–π, —á–µ—Ä–µ–∑ WebClient, RestTemplate –∏–ª–∏ Gateway.
–ü—Ä–∏–º–µ—Ä —Å RestTemplate:
```java
@Bean
public RestTemplate restTemplate() {
    return new RestTemplateBuilder()
           .interceptors(new TracingRestTemplateInterceptor())
           .build();
}
```
–ö–∞–∂–¥—ã–π interceptor –≤ RestTemplate ‚Äì —ç—Ç–æ —Ç–æ–∂–µ Chain of Responsibility:  
–æ–Ω –º–æ–∂–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å, –¥–æ–±–∞–≤–∏—Ç—å headers, –∞ –ø–æ—Ç–æ–º –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–ª—å—à–µ.
# üß© **4. Chain of Responsibility —á–µ—Ä–µ–∑ Spring Cloud Stream**
- Consumer-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã –≤ —Ü–µ–ø–æ—á–∫—É —á–µ—Ä–µ–∑ `@StreamListener` –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:
```java
@Bean
public Function<Message<Order>, Message<Order>> validate() {
    return message -> {
        // –≤–∞–ª–∏–¥–∞—Ü–∏—è
        return message;
    };
}

@Bean
public Function<Message<Order>, Message<Order>> enrich() {
    return message -> {
        // –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
        return message;
    };
}
```
Spring Cloud Stream –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–≤—è–∑—ã–≤–∞—Ç—å —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ `spring.cloud.stream.function.definition=validate|enrich`.
- –ó–¥–µ—Å—å `|` –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç **—Ü–µ–ø–æ—á–∫—É —Ñ—É–Ω–∫—Ü–∏–π**, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä—è–º–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π Chain of Responsibility.
# üß© **5. –ò—Ç–æ–≥: –∫–∞–∫ Spring Cloud —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω**

|–°—Ü–µ–Ω–∞—Ä–∏–π|–ö–∞–∫ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è|Chain of Responsibility|
|---|---|---|
|HTTP Gateway|Spring Cloud Gateway Filters|—Ñ–∏–ª—å—Ç—Ä—ã –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∫–∞–∂–¥—ã–π –º–æ–∂–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–ø—Ä–æ—Å|
|REST-–∫–ª–∏–µ–Ω—Ç—ã|RestTemplate / WebClient Interceptors|–∫–∞–∂–¥—ã–π interceptor –º–æ–∂–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å/–æ—Ç–≤–µ—Ç –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–ª—å—à–µ|
|–°–æ–±—ã—Ç–∏—è|Spring Cloud Stream —Ñ—É–Ω–∫—Ü–∏–∏|–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É —Ñ—É–Ω–∫—Ü–∏–π|
|–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞|Sleuth / Micrometer Tracing|–∫–∞–∂–¥—ã–π —Ñ–∏–ª—å—Ç—Ä/–∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç traceId/spanId|
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** —Ü–µ–ø–æ—á–∫–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —Ñ–∏–ª—å—Ç—Ä–æ–≤/—Ñ—É–Ω–∫—Ü–∏–π**, –∞ –Ω–µ –∂—ë—Å—Ç–∫–æ –≤ –∫–æ–¥–µ —Å–µ—Ä–≤–∏—Å–∞.
- –ú–æ–∂–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—Ç—å, —É–¥–∞–ª—è—Ç—å –∏–ª–∏ –ø–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏.