## Что такое сервлет в контексте Java EE?

- Сервлет — это Java-класс, реализующий интерфейс `javax.servlet.Servlet`, предназначенный для обработки HTTP-запросов и формирования HTTP-ответов.
- Он работает внутри контейнера сервлетов (например, Tomcat), который управляет его жизненным циклом.
- Сервлеты позволяют создавать динамический контент для веб-приложений, например, обрабатывать формы, взаимодействовать с базой данных и генерировать HTML.

---

## Как настроить Tomcat для запуска веб-приложения?

1. Создайте веб-приложение:
    
    - Структура должна содержать папки `WEB-INF`, внутри которой находится `web.xml` (декларация сервлетов, маппингов и т.п.).
    - В папке `WEB-INF/classes` разместите ваши `.class` файлы или скомпилированные `.jar`.
    - В `WEB-INF/lib` — сторонние библиотеки.
2. Разверните приложение:
    
    - Поместите папку вашего приложения в папку `webapps` Tomcat.
    - Или создайте `.war` архив и скопируйте его в `webapps`.
3. Запустите Tomcat:
    
    - Через скрипты `startup.bat` или `startup.sh`.
    - После запуска приложение будет доступно по URL:  
        `http://localhost:8080/имя_приложения/`
4. Проверьте работу:
    
    - Перейдите по URL и убедитесь, что ваше приложение загружено.

---

## Каковы основные отличия между сервлетами и JSP?

|Характеристика|Сервлеты|JSP (JavaServer Pages)|
|---|---|---|
|Назначение|Обработка логики, управление запросами|Генерация HTML-контента с возможностью вставки Java-кода|
|Стиль разработки|Код на Java, управляемый вручную|Разметка HTML с встроенным Java-кодом|
|Уровень абстракции|Более низкий уровень (программирование логики)|Более высокий уровень (разметка + логика)|
|Использование|Для обработки данных, бизнес-логики|Для отображения данных пользователю|
|Взаимодействие|Обычно вызываются из JSP или других компонентов|Может содержать скриплеты (`<% ... %>`) или использовать Expression Language (EL)|

---

## Как передать данные из сервлета в JSP?

1. В сервлете установите атрибуты в объекте `HttpServletRequest`:

```java
request.setAttribute("name", "John");
```

2. Перенаправьте или выполните диспетчеризацию на JSP:

```java
RequestDispatcher dispatcher = request.getRequestDispatcher("page.jsp");
dispatcher.forward(request, response);
```

3. В JSP получите данные через Expression Language:

```jsp
Hello, ${name}!
```

или через скриплеты:

```jsp
<%= request.getAttribute("name") %>
```

---

## Как настроить контекстное меню веб-приложения в Tomcat?

- В контексте веб-приложения можно настроить меню через HTML/JavaScript.
- Если речь о контекстном меню браузера — используйте JavaScript для обработки событий правой кнопки мыши (`contextmenu`).
- Для серверной части — настройка URL-маршрутов или конфигурации в `web.xml`.
- Также можно использовать файлы конфигурации Tomcat (`context.xml`) для настройки ресурсов или параметров окружения.

---

## Как использовать фильтры в сервлетах для управления доступом?

1. Создайте класс-фильтр, реализующий интерфейс `javax.servlet.Filter`.

```java
public class AuthFilter implements Filter {
    public void doFilter(ServletRequest request, ServletResponse response,
                         FilterChain chain) throws IOException, ServletException {
        HttpServletRequest req = (HttpServletRequest) request;
        HttpSession session = req.getSession(false);
        if (session != null && session.getAttribute("user") != null) {
            chain.doFilter(request, response); // разрешить доступ
        } else {
            ((HttpServletResponse) response).sendRedirect("login.jsp");
        }
    }
}
```

2. Зарегистрируйте фильтр в `web.xml`:

```xml
<filter>
    <filter-name>AuthFilter</filter-name>
    <filter-class>com.example.AuthFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>AuthFilter</filter-name>
    <url-pattern>/secured/*</url-pattern>
</filter-mapping>
```

Это обеспечит контроль доступа к защищённым ресурсам.

---

## Как использовать паттерн MVC в разработке веб-приложения на сервлетах и JSP?

- Model: бизнес-логика и данные (например, классы Java, взаимодействующие с базой).
- View: JSP страницы для отображения данных.
- Controller: сервлеты, которые обрабатывают запросы, вызывают модели и передают данные во View.

Пример:

1. Пользователь делает запрос к сервлету.
2. Сервлет обрабатывает запрос, вызывает бизнес-логику.
3. Полученные данные устанавливает как атрибуты запроса.
4. Перенаправляет на JSP страницу для отображения.

Это разделяет логику приложения и представление.

---

## Как настроить подключение к базе данных через JNDI в Tomcat?

1. В файле `context.xml` или глобальном `server.xml` добавьте ресурс DataSource:

```xml
<Resource name="jdbc/MyDB" auth="Container"
          type="javax.sql.DataSource"
          username="dbuser" password="dbpass"
          driverClassName="com.mysql.jdbc.Driver"
          url="jdbc:mysql://localhost:3306/mydb"
          maxTotal="20" maxIdle="10"/>
```

1. В приложении получите DataSource через JNDI:

```java
Context initCtx = new InitialContext();
DataSource ds = (DataSource) initCtx.lookup("java:/comp/env/jdbc/MyDB");
Connection conn = ds.getConnection();
```

1. Не забудьте добавить нужные драйверы JAR-файлы в каталог `lib` Tomcat.

---

## Какие существуют способы оптимизации производительности веб-приложения на сервлетах и JSP?

- Используйте соединения с базой данных через пул соединений (`DataSource`) вместо открытия новых.
- Кэшируйте часто используемые данные или результаты сложных вычислений.
- Минимизируйте использование тяжелых операций внутри сервлета/JSP.
- Используйте фильтры для предварительной обработки запросов.
- Оптимизируйте SQL-запросы и индексы базы данных.
- Используйте CDN для статического контента.
- Минимизируйте размер передаваемых данных (сжатие GZIP).
- Используйте шаблоны и компоненты для повторного использования кода.
- Обеспечьте правильную настройку JVM и конфигурацию Tomcat для высокой нагрузки.