## üß© –ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–æ–ø–∏–∫ –≤ Kafka
**–¢–æ–ø–∏–∫ (topic)** ‚Äî —ç—Ç–æ **–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∫–∞–Ω–∞–ª** –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É –ø—Ä–æ–¥—é—Å–µ—Ä–∞–º–∏ –∏ –∫–æ–Ω—Å—É–º–µ—Ä–∞–º–∏.  
–û–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç **—Ç–µ–º–∞—Ç–∏–∫—É –¥–∞–Ω–Ω—ã—Ö**, –Ω–∞–ø—Ä–∏–º–µ—Ä:
- `orders` ‚Äî –∑–∞–∫–∞–∑—ã
- `payments` ‚Äî –ø–ª–∞—Ç–µ–∂–∏
- `user-events` ‚Äî –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–ú–æ–∂–Ω–æ –¥—É–º–∞—Ç—å –æ —Ç–æ–ø–∏–∫–µ –∫–∞–∫ –æ **–ø–æ—Ç–æ–∫–µ —Å–æ–±—ã—Ç–∏–π –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞**.
## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–æ–ø–∏–∫–∞
–ö–∞–∂–¥—ã–π —Ç–æ–ø–∏–∫ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **–æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ (partitions)**:
```
Topic: orders
 ‚îú‚îÄ‚îÄ Partition 0
 ‚îÇ    ‚îú‚îÄ‚îÄ Offset 0 ‚Üí Order #1001
 ‚îÇ    ‚îú‚îÄ‚îÄ Offset 1 ‚Üí Order #1002
 ‚îÇ    ‚îî‚îÄ‚îÄ ...
 ‚îú‚îÄ‚îÄ Partition 1
 ‚îÇ    ‚îú‚îÄ‚îÄ Offset 0 ‚Üí Order #2001
 ‚îÇ    ‚îú‚îÄ‚îÄ Offset 1 ‚Üí Order #2002
 ‚îÇ    ‚îî‚îÄ‚îÄ ...
 ‚îî‚îÄ‚îÄ Partition 2
      ‚îú‚îÄ‚îÄ Offset 0 ‚Üí Order #3001
      ‚îî‚îÄ‚îÄ ...
```
### üìç –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ partition:
- –∏–º–µ–µ—Ç **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä (offset)** ‚Äî –ø–æ–∑–∏—Ü–∏—é –≤ –ª–æ–≥–µ;
- **–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω–µ—Ü** (append-only);
- **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è**, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å –µ–≥–æ —É–∂–µ –ø—Ä–æ—á–∏—Ç–∞–ª.
## ‚öôÔ∏è –ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã —Ä–∞–∑–¥–µ–ª—ã (partitions)
1. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (scalability)**  
    Partition ‚Äî —ç—Ç–æ –µ–¥–∏–Ω–∏—Ü–∞ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞.  
    –ß–µ–º –±–æ–ª—å—à–µ —Ä–∞–∑–¥–µ–ª–æ–≤, —Ç–µ–º –±–æ–ª—å—à–µ –ø—Ä–æ–¥—é—Å–µ—Ä–æ–≤ –∏ –∫–æ–Ω—Å—É–º–µ—Ä–æ–≤ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
2. **–ü–æ—Ä—è–¥–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π (ordering)**  
    Kafka –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç **–ø–æ—Ä—è–¥–æ–∫** —Ç–æ–ª—å–∫–æ **–≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ partition**,  
    –Ω–æ –Ω–µ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ partition‚Äô–∞–º–∏.
3. **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (fault tolerance)**  
    –ö–∞–∂–¥—ã–π partition –º–æ–∂–µ—Ç –∏–º–µ—Ç—å **—Ä–µ–ø–ª–∏–∫–∏** (copies) –Ω–∞ –¥—Ä—É–≥–∏—Ö –±—Ä–æ–∫–µ—Ä–∞—Ö.  
    –û–¥–∏–Ω –±—Ä–æ–∫–µ—Ä ‚Äî **–ª–∏–¥–µ—Ä**, –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî **—Ñ–æ–ª–ª–æ–≤–µ—Ä—ã**.  
    –ï—Å–ª–∏ –ª–∏–¥–µ—Ä —É–ø–∞–¥—ë—Ç ‚Äî –æ–¥–∏–Ω –∏–∑ —Ñ–æ–ª–ª–æ–≤–µ—Ä–æ–≤ –∑–∞–π–º—ë—Ç –µ–≥–æ –º–µ—Å—Ç–æ.
## üß† –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ø–∏–∫

|–†–æ–ª—å|–î–µ–π—Å—Ç–≤–∏–µ|–ü—Ä–∏–º–µ—Ä|
|---|---|---|
|**Producer**|–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–ø–∏–∫|`producer.send("orders", "OrderCreated")`|
|**Broker**|–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –Ω—É–∂–Ω–æ–º partition —Ç–æ–ø–∏–∫–∞|Partition 1|
|**Consumer**|–ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ç–æ–ø–∏–∫ –∏ —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è|`consumer.subscribe(["orders"])`|

–ü—Ä–∏–º–µ—Ä –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö:
```
Producer ‚Üí [orders topic] ‚Üí Consumer
```
## üîÅ –°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
Kafka **–Ω–µ —É–¥–∞–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∏—Ö —á—Ç–µ–Ω–∏—è** ‚Äî  
–≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –¥–µ–π—Å—Ç–≤—É–µ—Ç **–ø–æ–ª–∏—Ç–∏–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è (retention policy)**:
- –ø–æ –≤—Ä–µ–º–µ–Ω–∏: `retention.ms=604800000` (–Ω–∞–ø—Ä–∏–º–µ—Ä, 7 –¥–Ω–µ–π)
- –ø–æ —Ä–∞–∑–º–µ—Ä—É: `retention.bytes=1GB`
- –∏–ª–∏ ‚Äú–Ω–∞–≤—Å–µ–≥–¥–∞‚Äù (`retention.ms=-1`)
üìå –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ:
- —Ä–∞–∑–Ω—ã–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ;
- –º–æ–∂–Ω–æ **–ø–µ—Ä–µ—á–∏—Ç–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–±—ã—Ç–∏–π** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è).
## üîç –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–ø–∏–∫–∞ (CLI)
```bash
kafka-topics.sh --create \
  --topic orders \
  --bootstrap-server localhost:9092 \
  --partitions 3 \
  --replication-factor 2
```
–ó–¥–µ—Å—å:
- `--partitions 3` ‚Äî —Ç—Ä–∏ —Ä–∞–∑–¥–µ–ª–∞;
- `--replication-factor 2` ‚Äî –¥–≤–∞ –±—Ä–æ–∫–µ—Ä–∞ —Ö—Ä–∞–Ω—è—Ç –∫–æ–ø–∏–∏ –¥–∞–Ω–Ω—ã—Ö.
## ‚öñÔ∏è –û—Ç–ª–∏—á–∏–µ —Ç–æ–ø–∏–∫–∞ Kafka –æ—Ç –æ—á–µ—Ä–µ–¥–∏ RabbitMQ

|–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å|**Kafka Topic**|**RabbitMQ Queue**|
|---|---|---|
|–•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π|–õ–æ–≥ (append-only), —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Å—Ç–∞—é—Ç—Å—è –¥–∞–∂–µ –ø–æ—Å–ª–µ —á—Ç–µ–Ω–∏—è|–°–æ–æ–±—â–µ–Ω–∏—è —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏|
|–ü–æ—Ä—è–¥–æ–∫|–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤–Ω—É—Ç—Ä–∏ partition|–û–±—ã—á–Ω–æ FIFO|
|–ü–æ–¥–ø–∏—Å—á–∏–∫–∏|–ù–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä—É–ø–ø –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ|–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω consumer|
|–ò—Å—Ç–æ—Ä–∏—è|–ú–æ–∂–Ω–æ –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è|–ù–µ—Ç (—Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è)|
## üß© –ò—Ç–æ–≥–æ
> **Topic** ‚Äî —ç—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ Kafka.  
> –û–Ω:
> - –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–¥–Ω–æ–π —Ç–µ–º–∞—Ç–∏–∫–∏,
> - —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ **partition‚Äô—ã** –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è,
> - –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** –∏ **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫** –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞.