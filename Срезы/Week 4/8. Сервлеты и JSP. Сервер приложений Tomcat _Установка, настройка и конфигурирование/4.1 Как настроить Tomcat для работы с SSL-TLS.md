Настройка **SSL/TLS** в Tomcat позволяет обрабатывать **HTTPS-запросы**, обеспечивая шифрование данных между клиентом и сервером.
## **1. Подготовка ключа и сертификата**
Tomcat использует **Java KeyStore (JKS)**.
### Создание самоподписанного сертификата
```bash
keytool -genkey -alias tomcat -keyalg RSA -keystore keystore.jks -keysize 2048
```
- `-alias tomcat` — имя ключа
- `-keystore keystore.jks` — имя файла хранилища
- `-keyalg RSA` — алгоритм ключа
- `-keysize 2048` — размер ключа
В процессе вводите пароль и информацию о владельце (CN, OU, O, L, S, C).
Файл `keystore.jks` сохранится в текущей директории.
> Для продакшн обычно используют **сертификат от CA**, а не самоподписанный.
## **2. Размещение KeyStore**
- Поместите `keystore.jks` в безопасную папку, например:
```
<TOMCAT_HOME>\conf\keystore.jks
```
## **3. Настройка `server.xml`**
Откройте `<TOMCAT_HOME>/conf/server.xml` и найдите секцию `<Connector>` для HTTPS.
Пример конфигурации:
```xml
<Connector port="8443"
           protocol="org.apache.coyote.http11.Http11NioProtocol"
           maxThreads="200"
           SSLEnabled="true"
           scheme="https"
           secure="true"
           clientAuth="false"
           sslProtocol="TLS"
           keystoreFile="conf/keystore.jks"
           keystorePass="changeit" />
```
**Пояснения параметров:**

|Параметр|Значение|
|---|---|
|`port`|Порт HTTPS (обычно 443 или 8443)|
|`SSLEnabled`|Включение SSL|
|`scheme`|Схема (https)|
|`secure`|Указывает на защищённое соединение|
|`clientAuth`|Требовать клиентский сертификат (false = нет)|
|`sslProtocol`|Протокол TLS (TLS, TLSv1.2 и т.д.)|
|`keystoreFile`|Путь к JKS файлу|
|`keystorePass`|Пароль к KeyStore|
## **4. Перезапуск Tomcat**
- Windows:
```cmd
<TOMCAT_HOME>\bin\shutdown.bat
<TOMCAT_HOME>\bin\startup.bat
```
- Linux:
```bash
<TOMCAT_HOME>/bin/shutdown.sh
<TOMCAT_HOME>/bin/startup.sh
```
## **5. Проверка HTTPS**
1. Откройте браузер:
```
https://localhost:8443
```
2. Если используется самоподписанный сертификат, браузер выдаст предупреждение.
3. Для продакшн используйте сертификат, подписанный CA, чтобы предупреждения не было.
## **6. Рекомендации**
- **Порт 443** используется по умолчанию для HTTPS, но для теста можно оставить 8443.
- Для продакшн: используйте сертификат от доверенного CA (Let's Encrypt, DigiCert и др.).
- Можно включить **только TLS**, отключив старые протоколы SSL для безопасности:
```xml
sslEnabledProtocols="TLSv1.2,TLSv1.3"
```
- Настройте **редирект с HTTP на HTTPS** через `web.xml` или `Valve`.