–§–∏–ª—å—Ç—Ä—ã (**Servlet Filters**) ‚Äî —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –≤ Java EE (Jakarta EE), –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**.
## üß© 1. –ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–∏–ª—å—Ç—Ä –≤ —Å–µ—Ä–≤–ª–µ—Ç–∞—Ö
**–§–∏–ª—å—Ç—Ä (Filter)** ‚Äî —ç—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π:
- –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∏ –ø–æ–ø–∞–¥—É—Ç –≤ —Å–µ—Ä–≤–ª–µ—Ç –∏–ª–∏ JSP;
- –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å, –æ—Ç–≤–µ—Ç –∏–ª–∏ –¥–∞–∂–µ **–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø**;
- –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è **–¥–æ** –∏ **–ø–æ—Å–ª–µ** –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞.
## ‚öôÔ∏è 2. –¢–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π: –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞
–¢—ã –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä, —á—Ç–æ–±—ã:
- –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –≤–æ—à—ë–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ —Å–∏—Å—Ç–µ–º—É;
- —Ä–∞–∑—Ä–µ—à–∞—Ç—å –∏–ª–∏ –∑–∞–ø—Ä–µ—â–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º URL;
- –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞.
## ‚úÖ 3. –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞ –¥–æ—Å—Ç—É–ø–∞
### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
src/main/java/
 ‚îî‚îÄ‚îÄ com/example/filter/AuthFilter.java
src/main/webapp/
 ‚îî‚îÄ‚îÄ WEB-INF/web.xml
```
### üìò –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞
```java
package com.example.filter;

import jakarta.servlet.*;
import jakarta.servlet.annotation.WebFilter;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import java.io.IOException;

@WebFilter("/*") // –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
public class AuthFilter implements Filter {

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
            throws IOException, ServletException {

        HttpServletRequest req = (HttpServletRequest) request;
        HttpServletResponse res = (HttpServletResponse) response;

        String uri = req.getRequestURI();
        HttpSession session = req.getSession(false);

        boolean isLoginPage = uri.endsWith("login.jsp") || uri.endsWith("login");
        boolean isLoggedIn = session != null && session.getAttribute("user") != null;

        if (isLoggedIn || isLoginPage) {
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –∏–ª–∏ –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞ ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–∞–ª—å—à–µ
            chain.doFilter(request, response);
        } else {
            // –ò–Ω–∞—á–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞
            res.sendRedirect(req.getContextPath() + "/login.jsp");
        }
    }
}
```
### üìò –®–∞–≥ 2: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —á–µ—Ä–µ–∑ `web.xml` (–µ—Å–ª–∏ –±–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏)
```xml
<filter>
    <filter-name>AuthFilter</filter-name>
    <filter-class>com.example.filter.AuthFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>AuthFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
```
### üìò –®–∞–≥ 3: –°–µ—Ä–≤–ª–µ—Ç –¥–ª—è –ª–æ–≥–∏–Ω–∞
```java
@WebServlet("/login")
public class LoginServlet extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp)
            throws IOException, ServletException {

        String username = req.getParameter("username");
        String password = req.getParameter("password");

        if ("admin".equals(username) && "1234".equals(password)) {
            HttpSession session = req.getSession();
            session.setAttribute("user", username);
            resp.sendRedirect("home.jsp");
        } else {
            resp.sendRedirect("login.jsp?error=true");
        }
    }
}
```
## üîí 4. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä

|–≠—Ç–∞–ø|–û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|
|1Ô∏è‚É£|–ó–∞–ø—Ä–æ—Å –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ —Ñ–∏–ª—å—Ç—Ä (`AuthFilter`).|
|2Ô∏è‚É£|–§–∏–ª—å—Ç—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.|
|3Ô∏è‚É£|–ï—Å–ª–∏ –¥–∞ ‚Äî –∑–∞–ø—Ä–æ—Å –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –¥–∞–ª—å—à–µ (`chain.doFilter()`).|
|4Ô∏è‚É£|–ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç `redirect` –Ω–∞ `/login.jsp`.|
## üß† 5. –ú–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤
–ü—Ä–∏–º–µ—Ä:
- `AuthFilter` ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–æ–≥–∏–Ω
- `LoggingFilter` ‚Äî –ª–æ–≥–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
- `CompressionFilter` ‚Äî —Å–∂–∏–º–∞–µ—Ç –æ—Ç–≤–µ—Ç
Tomcat –∏ –¥—Ä—É–≥–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç –∏—Ö **–≤ –ø–æ—Ä—è–¥–∫–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏**.
## üöÄ 6. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø—Ä–∏—ë–º—ã
- **–ò—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
    ```java
    if (uri.startsWith("/static/") || uri.endsWith(".css") || uri.endsWith(".js")) {
        chain.doFilter(request, response);
        return;
    }
    ```
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ URL –ø–æ —Ä–æ–ª—è–º:**
    ```java
    if (uri.startsWith("/admin") && !userRole.equals("ADMIN")) {
        res.sendError(HttpServletResponse.SC_FORBIDDEN);
        return;
    }
    ```
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø—É—Ç–µ–π:**
    ```java
    @WebFilter("/secure/*")
    ```
## ‚ö†Ô∏è 7. –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

|–û—à–∏–±–∫–∞|–ü—Ä–∏—á–∏–Ω–∞|–†–µ—à–µ–Ω–∏–µ|
|---|---|---|
|–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login.jsp`|–§–∏–ª—å—Ç—Ä –Ω–µ –∏—Å–∫–ª—é—á–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞|–î–æ–±–∞–≤—å `if (isLoginPage)`|
|`NullPointerException` –ø—Ä–∏ `session.getAttribute`|`session == null`|–ò—Å–ø–æ–ª—å–∑—É–π `getSession(false)`|
|JSP –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è|–§–∏–ª—å—Ç—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã|–£—Ç–æ—á–Ω–∏ `url-pattern`|
## üí° 8. –†–µ–∑—é–º–µ

|–¶–µ–ª—å|–†–µ—à–µ–Ω–∏–µ|
|---|---|
|–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è|–§–∏–ª—å—Ç—Ä —Å `session.getAttribute("user")`|
|–ó–∞—â–∏—Ç–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø—É—Ç–∏ (`/admin/*`)|–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è `@WebFilter("/admin/*")`|
|–ü—Ä–æ–ø—É—Å–∫–∞—Ç—å —Å—Ç–∞—Ç–∏–∫—É –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫|–ò—Å–∫–ª—é—á–µ–Ω–∏—è –ø–æ URI|
|–£–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ—Ä—è–¥–∫–æ–º —Ñ–∏–ª—å—Ç—Ä–æ–≤|–ó–∞–¥–∞—Ç—å –≤ `web.xml` –≤ –Ω—É–∂–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏|
