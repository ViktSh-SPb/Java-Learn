## üîπ –ß—Ç–æ —Ç–∞–∫–æ–µ `Phaser`
`Phaser` (–∏–∑ –ø–∞–∫–µ—Ç–∞ `java.util.concurrent`) ‚Äî —ç—Ç–æ **—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä —Ñ–∞–∑**, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ **–ø–æ—ç—Ç–∞–ø–Ω–æ (—Ñ–∞–∑–∞–º–∏)**.
–û–Ω –ø–æ—Ö–æ–∂ –Ω–∞ —É–ª—É—á—à–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é `CyclicBarrier` –∏ `CountDownLatch`, –Ω–æ:
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–∑** (–∏—Ç–µ—Ä–∞—Ü–∏–π),
- –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –æ—Ç–ø–∏—Å—ã–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏,
- —É–¥–æ–±–µ–Ω –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –≥–¥–µ –≥—Ä—É–ø–ø—ã –ø–æ—Ç–æ–∫–æ–≤ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ä–∞–±–æ—Ç—É —à–∞–≥ –∑–∞ —à–∞–≥–æ–º.
## üîπ –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã
1. –ü–æ—Ç–æ–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ `Phaser` (`register()` –∏–ª–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ).
2. –ö–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –≤ —Ç–µ–∫—É—â–µ–π —Ñ–∞–∑–µ.
3. –ö–æ–≥–¥–∞ –ø–æ—Ç–æ–∫ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –≤ —Ñ–∞–∑–µ, –æ–Ω –≤—ã–∑—ã–≤–∞–µ—Ç **`arriveAndAwaitAdvance()`**:
    - –æ—Ç–º–µ—á–∞–µ—Ç, —á—Ç–æ –æ–Ω –∑–∞–≤–µ—Ä—à–∏–ª —Ñ–∞–∑—É;
    - –∂–¥—ë—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö, –ø–æ–∫–∞ –≤—Å–µ –Ω–µ –¥–æ–π–¥—É—Ç –¥–æ —ç—Ç–æ–≥–æ –∂–µ –º–æ–º–µ–Ω—Ç–∞.
4. –ö–æ–≥–¥–∞ –≤—Å–µ –ø–æ—Ç–æ–∫–∏ –ø—Ä–∏—à–ª–∏, `Phaser` –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —Ñ–∞–∑—É, –∏ –ø–æ—Ç–æ–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.
5. –ü–æ—Ç–æ–∫–∏ –º–æ–≥—É—Ç –æ—Ç–ø–∏—Å—ã–≤–∞—Ç—å—Å—è (`arriveAndDeregister()`), –µ—Å–ª–∏ –∏–º –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å.
## üîπ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø—Ä–æ–π—Ç–∏ —á–µ—Ä–µ–∑ —Ç—Ä–∏ —ç—Ç–∞–ø–∞ —Ä–∞–±–æ—Ç—ã:
```java
import java.util.concurrent.Phaser;

public class PhaserExample {
    public static void main(String[] args) {
        Phaser phaser = new Phaser(3); // 3 —É—á–∞—Å—Ç–Ω–∏–∫–∞

        for (int i = 1; i <= 3; i++) {
            int id = i;
            new Thread(() -> {
                task("–≠—Ç–∞–ø 1", phaser, id);
                task("–≠—Ç–∞–ø 2", phaser, id);
                task("–≠—Ç–∞–ø 3", phaser, id);
            }).start();
        }
    }

    private static void task(String phase, Phaser phaser, int id) {
        System.out.println("–ü–æ—Ç–æ–∫ " + id + " –≤—ã–ø–æ–ª–Ω—è–µ—Ç " + phase);
        try { Thread.sleep(1000); } catch (InterruptedException ignored) {}
        // –î–æ–∂–∏–¥–∞–µ–º—Å—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
        phaser.arriveAndAwaitAdvance();
    }
}
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
–í—Å–µ —Ç—Ä–∏ –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω—è—Ç **–≠—Ç–∞–ø 1**, –¥–æ–∂–¥—É—Ç—Å—è –¥—Ä—É–≥ –¥—Ä—É–≥–∞, –ø–æ—Ç–æ–º –≤—Å–µ –ø–µ—Ä–µ–π–¥—É—Ç –∫ **–≠—Ç–∞–ø—É 2**, –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.
## üîπ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Phaser`
1. **–ú–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–µ –∑–∞–¥–∞—á–∏** ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–Ω–≤–µ–π–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –≤—Å–µ –ø–æ—Ç–æ–∫–∏ –¥–æ–ª–∂–Ω—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è.
2. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π / —Å–∏–º—É–ª—è—Ü–∏–∏** ‚Äî –∫–∞–∂–¥—ã–π —à–∞–≥ —Å–∏–º—É–ª—è—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –∑–∞—Ç–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è.
3. **–ó–∞–º–µ–Ω–∞ `CountDownLatch` –∏–ª–∏ `CyclicBarrier`** –≤ —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ü–∏–∫–ª–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –≥–∏–±–∫–æ—Å—Ç—å.
4. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤** ‚Äî –∫–æ–≥–¥–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –Ω–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏ –∏–ª–∏ –æ—Ç–ø–∏—Å—ã–≤–∞—Ç—å—Å—è —Å—Ç–∞—Ä—ã–µ.
## üîπ –û—Ç–ª–∏—á–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä–æ–≤
- `CountDownLatch` ‚Äî –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π, `Phaser` –º–Ω–æ–≥–æ—Ä–∞–∑–æ–≤—ã–π (–º–Ω–æ–≥–æ —Ñ–∞–∑).
- `CyclicBarrier` ‚Äî –ø–æ—Ö–æ–∂, –Ω–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤; –≤ `Phaser` –º–æ–∂–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—è—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.
- `Phaser` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–∑** –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ "–±–∞—Ä—å–µ—Ä–∞".