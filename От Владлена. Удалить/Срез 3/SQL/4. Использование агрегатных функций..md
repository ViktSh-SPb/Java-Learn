### 1. Какая агрегатная функция используется для вычисления среднего значения столбца?

`AVG()` — вычисляет среднее арифметическое значение по выбранному столбцу.

---

### 2. Для чего используется агрегатная функция COUNT?

`COUNT()` подсчитывает количество строк, соответствующих заданному условию или в целом по таблице. Например, `COUNT(*)` считает все строки, а `COUNT(столбец)` — количество непустых значений в этом столбце.

---

### 3. Как рассчитать сумму значений по определенному столбцу?

Используйте функцию `SUM()`:


```sql
SELECT SUM(столбец) FROM таблица;
```

---

### 4. Как применить агрегатную функцию к столбцу с условием?

Добавьте условие `WHERE`:


```sql
SELECT SUM(столбец) FROM таблица WHERE условие;
```

---

### 5. Как объединить результаты агрегатных функций с GROUP BY?

`GROUP BY` группирует строки по одному или нескольким столбцам, после чего можно применять агрегатные функции к каждой группе:


```sql
SELECT группирующий_столбец, COUNT(*), AVG(другой_столбец)
FROM таблица
GROUP BY группирующий_столбец;
```

---

### 6. Как использовать агрегатную функцию для вычисления общего количества уникальных значений в столбце?

Используйте `COUNT(DISTINCT ...)`:


```sql
SELECT COUNT(DISTINCT столбец) FROM таблица;
```

---

### 7. Как реализовать оконные функции с использованием агрегатных функций?

Оконные функции позволяют выполнять агрегирование по окну (подмножеству данных), не группируя строки полностью. Например:


```sql
SELECT 
    столбец,
    AVG(столбец) OVER (PARTITION BY другой_столбец) AS среднее_по_группе
FROM таблица;
```

Это позволяет получить среднее значение внутри каждой группы без объединения строк.

---

### Стратегии оптимизации запросов с агрегатными функциями на больших объемах данных

- Индексация: создавайте индексы по колонкам, используемым в `WHERE`, `JOIN`, и `GROUP BY`.
- Разделение данных: предварительная фильтрация данных перед агрегацией для уменьшения объема обрабатываемых данных.
- Использование материализованных представлений: сохраняйте результаты сложных агрегаций для быстрого доступа.
- Параллельная обработка: используйте возможности СУБД для параллельного выполнения запросов.

---

### Как использовать агрегатные функции в сочетании с подзапросами для решения сложных задач анализа данных?

Пример: найти максимальное среднее значение по группам:


```sql
SELECT группа, AVG(значение)
FROM таблица
GROUP BY группа
HAVING AVG(значение) = (
    SELECT MAX(avg_value)
    FROM (
        SELECT AVG(значение) AS avg_value
        FROM таблица
        GROUP BY группа
    ) подзапрос
);
```

Здесь внутренний подзапрос вычисляет средние значения по группам, а внешний — выбирает группу с максимальным средним.