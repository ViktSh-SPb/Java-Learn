# Apply
**Git apply** - применяет изменения из патча (файла с дифом, например, созданного *git diff* или *git format-patch*, полученного извне(например по почте)) к рабочей директории или индексу. В отличии от *git am*, она не создает коммит автоматически.
## Основное использование
### 1. Применить патч к рабочей директории
```bash
git apply patch_file.patch
```
### 2. Применить патч и добавить изменения в индекс (staging area)
```bash
git apply --cached patch_file.patch
```
### 3. Проверить, применится ли патч (без реальных изменений)
```bash
git apply --check patch_file.patch
```
## Ключи

| Опция       | Описание                                                                |
| ----------- | ----------------------------------------------------------------------- |
| `--stat`    | Показать статистику изменений (без применения)                          |
| `--3way`    | Попытаться разрешить конфликты, используя *3-way merge*                 |
| `--reverse` | Применить патч в обратном направлении (отменить изменения)              |
| `--reject`  | Применить частично, сохраняя отклоненные изменения в .rej-файлах        |
| `-p<n>`     | Игнорировать n уровней пути (например, -p1 для патчей из поддиректорий) |
## Примеры
### 1. Создать и применить патч
```bash
# Создать патч из последних изменений
git diff > changes.patch

# Применить патч
git apply changes.patch
```
### 2. Применить патч с автоматическим разрешением конфликтов
```bash
git apply --3way changes.patch
```
### 3. Отменить изменения из патча
```bash
git apply --reverse changes.patch
```
## Отличия git apply от git am

| git apply                       | git am                                            |
| ------------------------------- | ------------------------------------------------- |
| Только применяет изменения      | Применяет изменения и создает коммит              |
| Не требует информации о коммите | Работает с патчами, созданными `git format-patch` |
| Можно применять частично        | Применяет всю серию патчей                        |
## Сценарии использования
### 1. Перенос изменений между ветками
```bash
git diff feature-branch > patch_file.patch
git checkout main
git apply patch_file.patch
```
### 2. Применение патчей из почты или внешних источников
```bash
curl https://example.com/patch.patch | git apply
```
### 3. Тестирование чужих изменений без коммита
```bash
git apply --check bugfix.patch   # проверить на конфликты
git apply bugfix.patch           # применить, если проверка прошла
```
## Ограничения
1. **Не создает коммит** - после изменения нужно сделать git add и git commit вручную.
2. **Конфликты** - если патч не применяется чисто, потребуется ручное исправление.
