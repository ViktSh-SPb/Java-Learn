## ‚öôÔ∏è –ß—Ç–æ —Ç–∞–∫–æ–µ –ª–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤ Hibernate
**–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (lazy loading)** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ  
(–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏–ª–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏) **–Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å—Ä–∞–∑—É**,  
–∞ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –∫ –Ω–∏–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø –≤ –∫–æ–¥–µ**.
### üîπ –ü—Ä–∏–º–µ—Ä
```java
@Entity
public class Author {
    @Id
    private Long id;

    private String name;

    @OneToMany(mappedBy = "author", fetch = FetchType.LAZY)
    private List<Book> books;
}
```
```java
Author author = entityManager.find(Author.class, 1L);
// SQL: SELECT * FROM authors WHERE id = 1

author.getBooks().size(); 
// ‚Üê –¢–æ–ª—å–∫–æ –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç Hibernate –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –∫–Ω–∏–≥–∏
// SQL: SELECT * FROM books WHERE author_id = 1
```
## üß† –ö–∞–∫ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤–Ω—É—Ç—Ä–∏ Hibernate
–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ `Author` Hibernate **–Ω–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π –æ–±—ä–µ–∫—Ç `List<Book>`**,  
–∞ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞—ë—Ç **–ø—Ä–æ–∫—Å–∏-–æ–±—ä–µ–∫—Ç** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `PersistentBag`),  
–∫–æ—Ç–æ—Ä—ã–π "–ª–µ–Ω–∏–≤–æ" –∑–Ω–∞–µ—Ç, –∫–∞–∫ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î, **–µ—Å–ª–∏ –∫ –Ω–µ–º—É –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è**.
–ü–æ–∫–∞ –ø—Ä–æ–∫—Å–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ‚Äî –∑–∞–ø—Ä–æ—Å–∞ –Ω–µ—Ç.  
–ù–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `author.getBooks().size()`),  
Hibernate –ø—ã—Ç–∞–µ—Ç—Å—è **–æ—Ç–∫—Ä—ã—Ç—å —Å–µ—Å—Å–∏—é** –∏ **–≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL**.
## ‚ö†Ô∏è –ö–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç `LazyInitializationException`
–û—à–∏–±–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –∫–æ–≥–¥–∞:
1. –°–µ—Å—Å–∏—è Hibernate —É–∂–µ **–∑–∞–∫—Ä—ã—Ç–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ `@Transactional` –º–µ—Ç–æ–¥–∞).
2. –ê –≤—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –ª–µ–Ω–∏–≤–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏–ª–∏ –ø–æ–ª—é.
### üîπ –¢–∏–ø–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä
```java
Author author = authorService.getAuthor(1L);
// –≤–Ω—É—Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ getAuthor() –±—ã–ª–∞ –∞–∫—Ç–∏–≤–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
// –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ –º–µ—Ç–æ–¥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å ‚Üí Session –∑–∞–∫—Ä—ã—Ç–∞

System.out.println(author.getBooks().size());
// ‚ùå LazyInitializationException: could not initialize proxy - no Session
```
## üîç –ü–æ—á–µ–º—É —Ç–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
Hibernate –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ **–æ—Å–Ω–æ–≤–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å** (`Author`),  
–∞ `books` –æ—Å—Ç–∞—ë—Ç—Å—è –ø—Ä–æ–∫—Å–∏-–æ–±—ä–µ–∫—Ç–æ–º (`PersistentBag`).
–ö–æ–≥–¥–∞ –≤—ã –æ–±—Ä–∞—â–∞–µ—Ç–µ—Å—å –∫ –Ω–µ–º—É –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–µ—Å—Å–∏–∏,  
Hibernate **–ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å**, –Ω–æ:
> –°–µ—Å—Å–∏—è —É–∂–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞ ‚Üí  
> —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î –Ω–µ—Ç ‚Üí  
> –ª–µ–Ω–∏–≤—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é –Ω–µ–ª—å–∑—è –ø–æ–¥–≥—Ä—É–∑–∏—Ç—å ‚Üí  
> –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `LazyInitializationException`.
## üîí –ì–¥–µ —ç—Ç–æ —á–∞—â–µ –≤—Å–µ–≥–æ —Å–ª—É—á–∞–µ—Ç—Å—è

|–ö–æ–Ω—Ç–µ–∫—Å—Ç|–ü–æ—á–µ–º—É|
|---|---|
|üî∏ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä Spring MVC|–º–µ—Ç–æ–¥ —Å–µ—Ä–≤–∏—Å–∞ –∑–∞–≤–µ—Ä—à–∏–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, –∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ LAZY-–ø–æ–ª—è–º|
|üî∏ REST API|–≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—É—â–Ω–æ—Å—Ç–∏ –Ω–∞–ø—Ä—è–º—É—é, Jackson –ª–µ–∑–µ—Ç –≤ –ª–µ–Ω–∏–≤—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏|
|üî∏ –¢–µ—Å—Ç—ã –±–µ–∑ @Transactional|–Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –ª–µ–Ω–∏–≤—ã–º –¥–∞–Ω–Ω—ã–º|
|üî∏ Detached Entities|—Å—É—â–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ –∫—ç—à, –ø–æ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ Persistence|
## üß© –ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å (–∫—Ä–∞—Ç–∫–æ)
1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–µ—Å—Å–∏–∏**  
    (`JOIN FETCH`, `EntityGraph`, `Hibernate.initialize()`).
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DTO / –ø—Ä–æ–µ–∫—Ü–∏–∏** –≤–º–µ—Å—Ç–æ —Å—É—â–Ω–æ—Å—Ç–µ–π.
3. **–î–µ—Ä–∂–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –≤–Ω—É—Ç—Ä–∏ `@Transactional` –º–µ—Ç–æ–¥–∞.**
4. **–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OSIV –≤ REST API**, –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —Å—Ç—Ä–æ–≥–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞.
## üí¨ –í–∏–∑—É–∞–ª—å–Ω–æ:
```
[ Hibernate Session –æ—Ç–∫—Ä—ã—Ç–∞ ]
  ‚Üì
  –ó–∞–≥—Ä—É–∂–∞–µ–º Author (–±–µ–∑ books)
  ‚Üì
  –û–±—Ä–∞—â–∞–µ–º—Å—è –∫ author.getBooks() ‚Äî Hibernate –¥–µ–ª–∞–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å
  ‚Üì
[ Session –∑–∞–∫—Ä—ã—Ç–∞ ]
  ‚Üì
  –õ—é–±–∞—è –ø–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ author.getBooks() ‚Üí LazyInitializationException ‚ùå
```