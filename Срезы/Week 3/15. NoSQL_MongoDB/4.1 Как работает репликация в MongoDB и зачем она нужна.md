## 1Ô∏è‚É£ **–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è**
**–†–µ–ø–ª–∏–∫–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å **—Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∫–æ–ø–∏–π –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö** (—É–∑–ª–∞—Ö).
- –í MongoDB —ç—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ **Replica Set** ‚Äî –Ω–∞–±–æ—Ä –∏–∑ **1 Primary** (–≥–ª–∞–≤–Ω—ã–π) –∏ **N Secondary** (–≤—Ç–æ—Ä–∏—á–Ω—ã—Ö) —É–∑–ª–æ–≤.
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å Primary –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –Ω–∞ Secondary.
üìå **–¶–µ–ª–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏:**
1. **–ü–æ–≤—ã—à–µ–Ω–∏–µ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏**
    - –ï—Å–ª–∏ Primary —É–ø–∞–ª, –æ–¥–∏–Ω –∏–∑ Secondary –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º Primary.
2. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**
    - Secondary –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —á—Ç–µ–Ω–∏—è –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏—è –±—ç–∫–∞–ø–æ–≤.
3. **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á—Ç–µ–Ω–∏—è**
    - –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ —á—Ç–µ–Ω–∏–µ –º–æ–∂–Ω–æ –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ Secondary, —Ä–∞–∑–≥—Ä—É–∂–∞—è Primary.
## 2Ô∏è‚É£ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Replica Set**
```
          +----------------+
          |    Client      |
          +----------------+
                   |
          ---------------------
          |                   |
      +--------+          +--------+
      | Primary|          |Secondary|
      +--------+          +--------+
           |                  |
           +------------------+
            –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
```
- **Primary** ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç **–∑–∞–ø–∏—Å–∏ (write)** –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤—Ç–æ—Ä–∏—á–Ω—ã–µ —É–∑–ª—ã.
- **Secondary** ‚Äî –ø–æ–ª—É—á–∞—é—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ **oplog** (–∂—É—Ä–Ω–∞–ª –æ–ø–µ—Ä–∞—Ü–∏–π Primary).
- –ï—Å–ª–∏ Primary –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –Ω–æ–≤–æ–≥–æ Primary** —á–µ—Ä–µ–∑ election.
## 3Ô∏è‚É£ **–¢–∏–ø—ã –æ–ø–µ—Ä–∞—Ü–∏–π –ø—Ä–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏**

|–û–ø–µ—Ä–∞—Ü–∏—è|Primary|Secondary|
|---|---|---|
|Insert / Update / Delete|–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ Primary|–†–µ–ø–ª–∏—Ü–∏—Ä—É–µ—Ç—Å—è –∏–∑ oplog|
|Read|–ú–æ–∂–Ω–æ, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ|–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —á—Ç–µ–Ω–∏—è|
üìå **Oplog** ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –≤ MongoDB, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è **–∂—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π** Primary.
- Secondary –ø—Ä–∏–º–µ–Ω—è–µ—Ç —ç—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏, —á—Ç–æ–±—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è.
## 4Ô∏è‚É£ **–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ**
1. Primary –ø–∞–¥–∞–µ—Ç.
2. Secondary –∑–∞–ø—É—Å–∫–∞–µ—Ç **election** (–≤—ã–±–æ—Ä –Ω–æ–≤–æ–≥–æ Primary).
3. –ö–ª–∏–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã–π Primary (–µ—Å–ª–∏ driver –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `replicaSet`).
‚úÖ –≠—Ç–æ –¥–µ–ª–∞–µ—Ç MongoDB **–æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π**.
## 5Ô∏è‚É£ **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ (–ø—Ä–æ—Å—Ç–µ–π—à–∏–π –ø—Ä–∏–º–µ—Ä)**
### üîπ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É–∑–ª–æ–≤ (mongo shell)
```javascript
rs.initiate({
   _id: "rs0",
   members: [
      { _id: 0, host: "localhost:27017" },
      { _id: 1, host: "localhost:27018" },
      { _id: 2, host: "localhost:27019" }
   ]
})
```
- `rs0` ‚Äî –∏–º—è Replica Set.
- `_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É–∑–ª–∞ –≤ –Ω–∞–±–æ—Ä–µ.
- –ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —É–∑–ª—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
### üîπ –ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å —Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π
**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Java Driver:**
```java
MongoClientSettings settings = MongoClientSettings.builder()
        .applyConnectionString(new ConnectionString("mongodb://localhost:27017,localhost:27018,localhost:27019/?replicaSet=rs0"))
        .build();

MongoClient mongoClient = MongoClients.create(settings);
MongoDatabase db = mongoClient.getDatabase("mydatabase");
```
- `replicaSet=rs0` —Å–æ–æ–±—â–∞–µ—Ç –¥—Ä–∞–π–≤–µ—Ä—É, —á—Ç–æ –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ Replica Set.
- –î—Ä–∞–π–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å.
## 6Ô∏è‚É£ **–ü–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏**
### ‚úÖ –ü–ª—é—Å—ã
- –í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á—Ç–µ–Ω–∏—è.
- –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ Primary.
- –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ Replica Set.
### ‚ùå –ú–∏–Ω—É—Å—ã
- –ó–∞–¥–µ—Ä–∂–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ (`replication lag`) –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–π **–Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö** –Ω–∞ Secondary.
- –£—Å–ª–æ–∂–Ω–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è.
- –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ (–ø–∞–º—è—Ç—å, –¥–∏—Å–∫–∏, —Å–µ—Ç—å).
### üîπ –ò—Ç–æ–≥:
1. **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è** = Primary + Secondary (Replica Set).
2. **Primary** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å—å, **Secondary** —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ oplog.
3. –ü–æ–≤—ã—à–∞–µ—Ç **–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å, –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è**.
4. –í —Å–ª—É—á–∞–µ —Å–±–æ—è Primary –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –Ω–æ–≤–æ–≥–æ Primary**.