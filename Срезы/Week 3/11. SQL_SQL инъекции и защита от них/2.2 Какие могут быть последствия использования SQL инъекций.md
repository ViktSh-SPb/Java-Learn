## Основные последствия SQL-инъекций
### 1. **Кража данных (Data theft)**
Злоумышленник может прочитать конфиденциальные записи: пользователи, пароли, банковские данные, персональные данные — вплоть до полного дампа БД.
### 2. **Изменение или удаление данных (Data tampering / Destruction)**
Атака может изменить балансы, статусы заказов, удалить таблицы или записи, что нарушает целостность бизнеса и приводит к потерям.
### 3. **Обход аутентификации / авторизации**
Простейшая инъекция может позволить получить доступ под учётной записью администратора, обойти логин/пароль.
### 4. **Получение привилегий / эскалация прав**
Через инъекцию можно выполнить команды, которые приведут к повышению привилегий учетной записи БД или даже выполнению команд ОС (если есть уязвимости).
### 5. **Выполнение произвольных команд на сервере (RCE, возможно)**
В некоторых конфигурациях (например, при включённом выполнении функций, запуска внешних команд через расширения) возможен RCE — запуск команд ОС.
### 6. **Построение бекдоров и долговременный доступ**
Атакующий может вставить «ловушки» — триггеры, расширения, скрытые учетные записи, которые обеспечат постоянный доступ.
### 7. **Эксплуатация для дальнейшего проникновения (lateral movement)**
Получив доступ к БД, атакующий может получить креды для других сервисов, сканировать сеть и двигаться дальше по инфраструктуре.
### 8. **Отказ в обслуживании (DoS)**
Инъекция может инициировать тяжёлые запросы: массовые JOIN, Cartesian product, долгие транзакции или DROP TABLE — всё это может вывести сервис из строя.
### 9. **Юридические и нормативные последствия**
Утечка PII / платёжных данных ведёт к штрафам (GDPR, PCI DSS), искам пользователей и требованиям уведомлений.
### 10. **Финансовые потери и простой бизнеса**
Прямые убытки, затраты на расследование, восстановление данных, компенсации клиентам, падение выручки.
### 11. **Убыток репутации**
Доверие клиентов и партнёров серьёзно страдает — восстановление бренда дорого и долго.
## Как возрастает риск в зависимости от контекста
- **Инъекция в публичном веб-фронтенде** → высокая вероятность массовых утечек.
- **Инъекция, работающая через админку** → критическая угроза (админ-доступ).
- **Доступ к БД с системными привилегиями** → риск RCE и полного контроля над сервером.
## Немедленные действия при обнаружении SQL-инъекции
1. **Изолировать уязвимый сервис** (если возможно) — приостановить внешний доступ или поставить приложение в read-only режим.
2. **Сменить пароли/ключи БД**, особенно учётных записей с широкими правами.
3. **Сохранить логи и дампы** (WAF, БД, приложение, сетевые логи) — для расследования.
4. **Провести forensics**: определить объём утечки/измнений.
5. **Откатить/восстановить данные** из резервной копии, если требуется.
6. **Уведомить руководство/юристов/регуляторов** в соответствии с политиками.
7. **Провести исправление уязвимости** — параметризованные запросы, валидация, WAF, ограничение прав.
8. **Провести аудит и усилить мониторинг** (IDS/IPS, SIEM, целевые оповещения по аномалиям запросов).
## Как предотвратить (ключевые меры, checklist)
- **Параметризованные запросы / prepared statements** — основная защита.
- **ORM / query builders** — правильно используемые ORM снижают риск.
- **Валидация входа по белому списку** (не только экранирование).
- **Минимизация привилегий**: приложение использует ограничённого DB-пользователя.
- **Использование WAF** и правил для обнаружения SQLi.
- **Регулярные тесты на проникновение / SAST/DAST и код-ревью**.
- **Логи и мониторинг аномалий** (необычные длительные запросы, частые ошибки, UNION/`--` в URL).
- **Хеширование/сервисные токены** для секретов, безопасный доступ к БД.
- **Обновление ПО** (СУБД, драйверов, фреймворков) — патчи закрывают уязвимости.
## Заключение (одно предложение)
SQL-инъекции — одна из самых опасных и распространённых уязвимостей: они могут привести к утечке и порче данных, RCE, юридическим и финансовым потерям; защита базируется на параметризации запросов, минимизации прав, мониторинге и регулярном тестировании.