üëâ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–ª–∞–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞** ‚Äî —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ —É—Å–∫–æ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.  
–°–º—ã—Å–ª –≤ —Ç–æ–º, —á—Ç–æ–±—ã **–ø–æ–Ω—è—Ç—å, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –°–£–ë–î –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å**, –∏ **–≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ö–µ–º—É, –∏–Ω–¥–µ–∫—Å—ã –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ –¥–µ—à–µ–≤–ª–µ –∏ –±—ã—Å—Ç—Ä–µ–µ.
## üß≠ 1. –ê–Ω–∞–ª–∏–∑ –ø–ª–∞–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞
–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- **PostgreSQL**:
```sql
EXPLAIN ANALYZE SELECT * FROM orders WHERE customer_id = 10;
```
- **MySQL**:
```sql
EXPLAIN SELECT * FROM orders WHERE customer_id = 10;
```
- **SQL Server**:  
    —á–µ—Ä–µ–∑ `SET SHOWPLAN_ALL ON` –∏–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –ø–ª–∞–Ω–∞ –≤ SSMS.
üìå –ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å:
- ‚úÖ **–¢–∏–ø —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** (Seq Scan, Index Scan, Index Seek, Full Table Scan)
- üßÆ **–û—Ü–µ–Ω–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–æ–∫** (Rows / Estimate)
- üß≠ **Join –∞–ª–≥–æ—Ä–∏—Ç–º—ã** (Nested Loop, Hash Join, Merge Join)
- üìä **–°—Ç–æ–∏–º–æ—Å—Ç—å** (Cost)
- üß≠ **–§–∏–ª—å—Ç—Ä—ã –∏ —É—Å–ª–æ–≤–∏—è**
## ‚ö° 2. –ù–∞—Ö–æ–¥–∏–º ‚Äú—É–∑–∫–∏–µ –º–µ—Å—Ç–∞‚Äù (bottlenecks)
–í–æ—Ç —Ç–∏–ø–∏—á–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:

|–ü—Ä–∏–∑–Ω–∞–∫ –≤ –ø–ª–∞–Ω–µ|–í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞|
|---|---|
|`Seq Scan` –Ω–∞ –±–æ–ª—å—à–æ–π —Ç–∞–±–ª–∏—Ü–µ|–ù–µ—Ç –Ω—É–∂–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –∏–ª–∏ –ø–ª–æ—Ö–∞—è —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å|
|–û—á–µ–Ω—å –º–Ω–æ–≥–æ –æ—Ü–µ–Ω–æ—á–Ω—ã—Ö —Å—Ç—Ä–æ–∫|–ù–µ–≤–µ—Ä–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞|
|Hash Join / Merge Join —Å –±–æ–ª—å—à–∏–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏|–ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π|
|`Sort` —Å –±–æ–ª—å—à–∏–º cost|–ù–µ—Ç –∏–Ω–¥–µ–∫—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫|
|`Filter` –ø–æ—Å–ª–µ JOIN|–£—Å–ª–æ–≤–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ ON –∏–ª–∏ WHERE —Ä–∞–Ω—å—à–µ|
|`Materialize`|–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞ –±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è|
## üß∞ 3. –ú–µ—Ç–æ–¥—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
### üìå 3.1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
- –ï—Å–ª–∏ –≤–∏–¥–µ–Ω **Seq Scan**, –∞ —Ñ–∏–ª—å—Ç—Ä –æ—á–µ–Ω—å —Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ã–π:
```sql
CREATE INDEX idx_orders_customer_id ON orders(customer_id);
```
‚Üí –ü–ª–∞–Ω –º–æ–∂–µ—Ç —Å–º–µ–Ω–∏—Ç—å—Å—è —Å `Seq Scan` –Ω–∞ `Index Seek` –∏–ª–∏ `Index Scan`.
- –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:
```sql
CREATE INDEX idx_orders_date_customer ON orders(order_date, customer_id);
```
‚Üí –°–£–ë–î –º–æ–∂–µ—Ç –Ω–µ –¥–µ–ª–∞—Ç—å `Sort`, –∞ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫.
### üìä 3.2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
–ï—Å–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–ª–∞–Ω –∏–∑-–∑–∞ –ø–ª–æ—Ö–∏—Ö –æ—Ü–µ–Ω–æ–∫:
```sql
ANALYZE orders;
```
‚Üí –ü–ª–∞–Ω –ø–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å Hash Join –Ω–∞ Nested Loop, –µ—Å–ª–∏ —Ä–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –º–µ–Ω—å—à–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ.
### üß≠ 3.3. –ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ / —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –£—Å–ª–æ–≤–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ –ª—É—á—à–µ —Å—Ç–∞–≤–∏—Ç—å **–∫–∞–∫ –º–æ–∂–Ω–æ —Ä–∞–Ω—å—à–µ** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –Ω–µ –¥–æ–≥–∞–¥–∞—Ç—å—Å—è.
- –ò–Ω–æ–≥–¥–∞ —Ñ–∏–ª—å—Ç—Ä –≤ `JOIN ... ON` —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ, —á–µ–º –≤ `WHERE`.
- –ü–æ–¥–∑–∞–ø—Ä–æ—Å—ã —á–∞—Å—Ç–æ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `JOIN` –∏–ª–∏ `EXISTS` ‚Üí –±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω.
üìå –ü—Ä–∏–º–µ—Ä:
```sql
-- –ú–µ–¥–ª–µ–Ω–Ω–µ–µ
SELECT * FROM orders WHERE customer_id IN (SELECT id FROM customers WHERE country = 'NL');

-- –ë—ã—Å—Ç—Ä–µ–µ
SELECT o.* FROM orders o
JOIN customers c ON o.customer_id = c.id
WHERE c.country = 'NL';
```
### üßÆ 3.4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **Nested Loop** ‚Äî —Ö–æ—Ä–æ—à–æ –ø—Ä–∏ –º–∞–ª–æ–º –≤–Ω–µ—à–Ω–µ–º –Ω–∞–±–æ—Ä–µ + –∏–Ω–¥–µ–∫—Å –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ç–∞–±–ª–∏—Ü–µ.
- **Hash Join** ‚Äî —Ö–æ—Ä–æ—à–æ –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö –±–µ–∑ –∏–Ω–¥–µ–∫—Å–æ–≤.
- **Merge Join** ‚Äî —Ö–æ—Ä–æ—à–æ –ø—Ä–∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤—Ö–æ–¥–∞—Ö.
üìå –ï—Å–ª–∏ Hash Join —Ç—è–Ω–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö, –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –∏–ª–∏ –ø–æ—Ä—è–¥–æ–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.
### ü™Ñ 3.5. –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- `DISTINCT`, `ORDER BY`, `GROUP BY` –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ—Ä–æ–≥–∏–º–∏.
- –ï—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω—ã ‚Äî —É–±–∏—Ä–∞—Ç—å.
- –ï—Å–ª–∏ –Ω—É–∂–Ω—ã ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã, —á—Ç–æ–±—ã –Ω–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —è–≤–Ω–æ.
### üß† 3.6. –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –±–æ–ª—å—à—É—é —Ç–∞–±–ª–∏—Ü—É ‚Äî **–ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º** –ø–æ –¥–∞—Ç–µ –∏–ª–∏ –∫–ª—é—á—É.
- –ß–∞—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Ç—è–∂–µ–ª—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ **–º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**.
### üß∞ 3.7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –°–£–ë–î
–ò–Ω–æ–≥–¥–∞ –ø–ª–∞–Ω –ø–ª–æ—Ö–æ–π –∏–∑-–∑–∞ cost-–º–æ–¥–µ–ª–∏:
- `random_page_cost`
- `work_mem`
- `max_parallel_workers_per_gather`
üìå –£–º–µ–Ω—å—à–∏–≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–ª—É—á–∞–π–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è, –º–æ–∂–Ω–æ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å.
## üöÄ 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
```sql
EXPLAIN ANALYZE ...
```
–°—Ä–∞–≤–Ω–∏–≤–∞–µ–º:
- –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- —Ä–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫
- –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω–¥–µ–∫—Å—ã –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
‚úÖ –¶–µ–ª—å ‚Äî —á—Ç–æ–±—ã –ø–ª–∞–Ω —Å—Ç–∞–ª –ø—Ä–æ—â–µ, –¥–µ—à–µ–≤–ª–µ –∏ –±—ã—Å—Ç—Ä–µ–µ.
## üèÅ –ò—Ç–æ–≥: –ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ –ø–ª–∞–Ω—É –∑–∞–ø—Ä–æ—Å–∞
1. üìà –ü–æ–ª—É—á–∏—Ç—å –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
2. üïµÔ∏è –ù–∞–π—Ç–∏ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ (Seq Scan, Hash Join –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö, Sort, Filter –∏ —Ç. –¥.).
3. üß∞ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
    - –∏–Ω–¥–µ–∫—Å—ã
    - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞
    - —Ç–∏–ø—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
    - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ cost-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
4. üöÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–π –ø–ª–∞–Ω –∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
5. üîÅ –ü–æ–≤—Ç–æ—Ä—è—Ç—å, –ø–æ–∫–∞ –Ω–µ –¥–æ–±—å–µ—Ç–µ—Å—å —Ä–∞–∑—É–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.