# Merge
**Git merge** - это команда, которая объединяет изменения из одной ветки в другую, создавая новый коммит слияния (*merge commit*). Это один из основных способов интеграции изменений в Git.
Когда вы выполняете `git merge`, Git:
1. Находит общего предка двух веток.
2. Определяет разницу (*diff*) между ними.
3. Создает новый коммит, который объединяет изменения (если нужно).
В отличие от `rebase`, `merge` не перезаписывает историю, а сохраняет ее в виде коммитов слияния.
## Типы слияния (Merge Strategies)
### 1. Fast-Forward Merge (Быстрая перемотка)
Происходит, если целевая ветка (*main*) не изменилась с момента создания ветки (*feature*).
```bash
git checkout main
git merge feature   # Просто перемещает указатель main на feature
```
Результат: Линейная история без лишних коммитов.
### 2. Recursive Merge (Обычное слияние)
Если в *main* были изменения, Git создает новый коммит слияния.
```bash
git checkout main
git merge feature   # Создает merge-коммит
```
Результат: История с ветвлениями и явными merge-коммитами.
### 3. Squash Merge (Слияние с объединением коммитов)
Объединяет все изменения из *feature* в один новый коммит в *main*.
```bash
git checkout main
git merge --squash feature
git commit -m "Объединенные изменения из feature"
```
✅ Плюсы: Чистая история без лишних коммитов.
❌ Минусы: Теряется информация о каждом отдельном изменении.
## Как разрешать конфликты при Merge
Если Git не может автоматически объединить изменения, он останавливается и сообщает о конфликте.
### Шаги для решения
1. Проверить конфликтующие файлы:
```bash
git status
```
1. Открыть файлы и исправить конфликты (между <<<<<<< и >>>>>>>).
2. Добавить исправленные файлы:
```bash
git add файл_с_конфликтом
```
1. Завершить слияние:
```bash
git commit
```
## Отмена слияния
### 1. Если merge еще не закоммичен
```bash
git merge --abort                   # Отмена в процессе слияния
```
### 2. Если merge уже закоммичен
```bash
git reset --hard HEAD~1             # Удалить последний коммит (Осторожно!)
```
Или более безопасный вариант:
```bash
git revert -m 1 MERGE_COMMIT_HASH   # Создает отменяющий коммит
```
## Полезные команды для Merge

| Команда                                 | Описание                                                                        |
| --------------------------------------- | ------------------------------------------------------------------------------- |
| `git merge --no-ff`                     | Всегда создает merge-коммит (даже при возможности fast-forward)                 |
| <nobr>`git log --graph --oneline`<nobr> | Показать историю с визуализацией ветвления                                      |
| `git mergetool`                         | Запустить внешний инструмент для разрешения конфликтов (например, meld, kdiff3) |
