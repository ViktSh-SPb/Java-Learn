–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è **JMX (Java Management Extensions)** —Å **Prometheus** –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏–∑ Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, Spring Boot, Tomcat, Kafka) –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Ö —á–µ—Ä–µ–∑ Prometheus/Grafana. –ù–∏–∂–µ –ø–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ.
## 1Ô∏è‚É£ –í–∫–ª—é—á–µ–Ω–∏–µ JMX –≤ Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å **JMX Remote**. –ü—Ä–∏–º–µ—Ä –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
java -Dcom.sun.management.jmxremote \
     -Dcom.sun.management.jmxremote.port=9010 \
     -Dcom.sun.management.jmxremote.authenticate=false \
     -Dcom.sun.management.jmxremote.ssl=false \
     -jar myapp.jar
```
**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
- `jmxremote.port=9010` ‚Äî –ø–æ—Ä—Ç –¥–ª—è JMX.
- `authenticate=false` –∏ `ssl=false` ‚Äî —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ SSL.
–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ **Spring Boot**, –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å Actuator —Å JMX:
```yaml
management:
  endpoints:
    jmx:
      exposure:
        include: '*'
```
## 2Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ JMX Exporter (Prometheus)
[Prometheus JMX Exporter](https://github.com/prometheus/jmx_exporter) ‚Äî —ç—Ç–æ Java –∞–≥–µ–Ω—Ç –∏–ª–∏ standalone HTTP-—Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç JMX-–º–µ—Ç—Ä–∏–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç Prometheus.
### –í–∞—Ä–∏–∞–Ω—Ç 1: Java Agent
1. –°–∫–∞—á–∞–π—Ç–µ JMX Exporter jar (–Ω–∞–ø—Ä–∏–º–µ—Ä `jmx_prometheus_javaagent-0.21.0.jar`).
2. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é YAML (`config.yaml`) —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:
```yaml
rules:
  - pattern: "java.lang:type=Memory"
    name: jvm_memory_used_bytes
    type: GAUGE
    attr: HeapMemoryUsage.used
```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∞–≥–µ–Ω—Ç–æ–º:
```bash
java -javaagent:/path/to/jmx_prometheus_javaagent-0.21.0.jar=9404:/path/to/config.yaml \
     -jar myapp.jar
```
- –ü–æ—Ä—Ç `9404` –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω Prometheus –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫.
### –í–∞—Ä–∏–∞–Ω—Ç 2: Standalone HTTP —Å–µ—Ä–≤–µ—Ä
- JMX Exporter –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —É–¥–∞–ª—ë–Ω–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –ø–æ JMX Port.
- –ö–æ–Ω—Ñ–∏–≥ YAML –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω.
## 3Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Prometheus
–î–æ–±–∞–≤—å—Ç–µ job –≤ –∫–æ–Ω—Ñ–∏–≥ `prometheus.yml`:
```yaml
scrape_configs:
  - job_name: 'java_app'
    static_configs:
      - targets: ['localhost:9404']
```
- Prometheus —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å JMX-–º–µ—Ç—Ä–∏–∫–∏ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
## 4Ô∏è‚É£ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Grafana
1. –°–æ–∑–¥–∞–π—Ç–µ datasource Prometheus –≤ Grafana.
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã JVM / Spring Boot (–µ—Å—Ç—å –Ω–∞ Grafana.com).
3. –ú–µ—Ç—Ä–∏–∫–∏, –¥–æ—Å—Ç—É–ø–Ω—ã–µ —á–µ—Ä–µ–∑ JMX Exporter: –ø–∞–º—è—Ç—å, GC, –ø–æ—Ç–æ–∫–∏, CPU, –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ç.–¥.
## üîπ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ **–≤–∫–ª—é—á–∞–π—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ SSL** –¥–ª—è JMX.
- –î–ª—è –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **standalone JMX Exporter** ‚Üí –º–µ–Ω—å—à–µ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–±–æ—Ä —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ ‚Üí —ç–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ Prometheus.