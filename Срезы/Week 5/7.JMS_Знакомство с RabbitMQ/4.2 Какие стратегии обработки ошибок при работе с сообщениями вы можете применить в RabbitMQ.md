–í RabbitMQ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç **–Ω–µ —Ç–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ**, **–æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É** –∏ **–∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**.
## 1Ô∏è‚É£ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (Acknowledgements)
- **Manual ack (`autoAck=false`)**:
    - Consumer –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —É—Å–ø–µ—à–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ `ack`.
    - –ï—Å–ª–∏ consumer –ø–∞–¥–∞–µ—Ç –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ ack ‚Üí RabbitMQ **–ø–µ—Ä–µ–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –¥—Ä—É–≥–æ–º—É consumer**.
- **–ü–ª—é—Å—ã:** –Ω–∞–¥—ë–∂–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞;
- **–ú–∏–Ω—É—Å—ã:** –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ–µ.
**–ü—Ä–∏–º–µ—Ä –Ω–∞ Java:**
```java
channel.basicAck(deliveryTag, false);
```
## 2Ô∏è‚É£ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (Retry)
- –ï—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å, –º–æ–∂–Ω–æ **–Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—Ç—å ack**, –∏ RabbitMQ **–æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ** –¥—Ä—É–≥–æ–º—É consumer –∏–ª–∏ —Ç–æ–º—É –∂–µ –ø–æ—Å–ª–µ –ø–∞—É–∑—ã.
- –ß–∞—Å—Ç–æ –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç—Å—è —Å **–æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –æ—á–µ—Ä–µ–¥—è–º–∏** (Delayed Queues) –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏.
## 3Ô∏è‚É£ Dead Letter Queue (DLQ)
- –°–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ø—ã—Ç–æ–∫, **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é "–º–µ—Ä—Ç–≤—É—é –æ—á–µ—Ä–µ–¥—å" (Dead Letter Queue)**.
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
    - –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è,
    - –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏,
    - –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–∑–∂–µ.
**–ü—Ä–∏–º–µ—Ä –ø–æ–ª–∏—Ç–∏–∫–∏:**
```bash
rabbitmqctl set_policy DLX ".*" '{"dead-letter-exchange":"dlx"}'
```
## 4Ô∏è‚É£ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∏—Å–ª–∞ –ø–æ–ø—ã—Ç–æ–∫ (TTL + Retry Queue)
- –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å —Å **TTL (time-to-live)**, –∞ –ø–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è TTL ‚Äî –≤ DLQ –∏–ª–∏ –∏—Å—Ö–æ–¥–Ω—É—é –æ—á–µ—Ä–µ–¥—å –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π**.
**–°—Ö–µ–º–∞:**
```
Queue ‚Üí Consumer ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞
           ‚îî‚îÄ fail ‚Üí Retry Queue (TTL) ‚Üí Back to Queue
           ‚îî‚îÄ –ø–æ—Å–ª–µ n –ø–æ–ø—ã—Ç–æ–∫ ‚Üí DLQ
```
## 5Ô∏è‚É£ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫
- **–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –º–æ–∂–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.
- –í –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å DLQ –ø–æ–∑–≤–æ–ª—è–µ—Ç **–≤—ã—è–≤–ª—è—Ç—å —à–∞–±–ª–æ–Ω—ã –æ—à–∏–±–æ–∫** –∏ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –∏—Ö.
## 6Ô∏è‚É£ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **priority queues**, —á—Ç–æ–±—ã **–≤–∞–∂–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å —Ä–∞–Ω—å—à–µ**.
- –°–æ–æ–±—â–µ–Ω–∏—è —Å –º–µ–Ω—å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –º–æ–≥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –ø–æ–∑–∂–µ –∏–ª–∏ –¥–∞–∂–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –Ω–∞–≥—Ä—É–∑–∫–µ.
## 7Ô∏è‚É£ Transaction –∏ Publisher Confirms
- –î–ª—è –ø—Ä–æ–¥—é—Å–µ—Ä–æ–≤: –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Publisher Confirms**, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ **–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ –æ—á–µ—Ä–µ–¥—å**.
- –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞.
## üîπ –ò—Ç–æ–≥
–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ RabbitMQ:

|–°—Ç—Ä–∞—Ç–µ–≥–∏—è|–°—É—Ç—å|–ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å|
|---|---|---|
|**Manual Ack**|Consumer –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É|–ù–∞–¥—ë–∂–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π|
|**Retry / Requeue**|–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏|–í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ|
|**Dead Letter Queue**|–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä—É—é—Ç—Å—è|–ù–µ—É—Å—Ç—Ä–∞–Ω–∏–º—ã–µ –æ—à–∏–±–∫–∏ –∏–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ –ø–æ–ø—ã—Ç–æ–∫|
|**TTL + Retry Queue**|–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π|–†–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏|
|**Priority Queues**|–í–∞–∂–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ä–∞–Ω—å—à–µ|–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏|
|**Publisher Confirms**|–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–¥—é—Å–µ—Ä–∞|–ù–∞–¥—ë–∂–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ|
