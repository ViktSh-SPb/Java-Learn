В Gradle можно создавать **кастомные задачи (custom tasks)** с использованием Groovy или Kotlin DSL, чтобы автоматизировать любые операции, например, копирование файлов, генерацию отчетов, выполнение скриптов и т.д.
## 1️⃣ Кастомная задача в Groovy (`build.gradle`)
### 1.1 Простая задача
```groovy
task hello {
    doLast {
        println 'Hello, Gradle!'
    }
}
```
- `task hello` — объявление задачи с именем `hello`.
- `doLast` — блок, который выполняется **в конце задачи** (можно использовать `doFirst` для начала).
**Запуск задачи:**
```bash
gradle hello
```
Вывод:
```
> Task :hello
Hello, Gradle!
```
### 1.2 Задача с параметрами и действиями
```groovy
task greet {
    ext.username = 'Viktor' // пользовательская переменная

    doLast {
        println "Hello, $username!"
    }
}
```
- `ext` — позволяет добавить **пользовательские свойства** к задаче.
### 1.3 Создание задачи через `tasks.register`
```groovy
tasks.register('copyFiles') {
    doLast {
        copy {
            from 'src/main/resources'
            into 'build/resourcesCopy'
        }
        println 'Files copied!'
    }
}
```
- `tasks.register` — современный способ объявления задач (ленивая конфигурация, улучшает производительность).
## 2️⃣ Кастомная задача в Kotlin (`build.gradle.kts`)
### 2.1 Простая задача
```kotlin
tasks.register("hello") {
    doLast {
        println("Hello, Gradle!")
    }
}
```
- `.register()` используется вместо `task hello {}` для **ленивой конфигурации**.
### 2.2 Задача с параметром
```kotlin
tasks.register("greet") {
    val username = "Viktor"

    doLast {
        println("Hello, $username!")
    }
}
```
- Локальные переменные и доступ к Gradle API через Kotlin DSL.
### 2.3 Копирование файлов
```kotlin
tasks.register<Copy>("copyFiles") {
    from("src/main/resources")
    into("build/resourcesCopy")
    doLast {
        println("Files copied!")
    }
}
```
- Можно использовать типизированные задачи (`Copy`, `JavaCompile`, `Jar`) для упрощения конфигурации.
## 3️⃣ Создание пользовательского класса задачи (Groovy и Kotlin)
### 3.1 Groovy
```groovy
class GreetingTask extends DefaultTask {
    String greeting = 'Hello'

    @TaskAction
    def greet() {
        println "${greeting}, Gradle!"
    }
}

task myGreet(type: GreetingTask) {
    greeting = 'Hi'
}
```
### 3.2 Kotlin
```kotlin
import org.gradle.api.DefaultTask
import org.gradle.api.tasks.TaskAction

open class GreetingTask : DefaultTask() {
    var greeting: String = "Hello"

    @TaskAction
    fun greet() {
        println("$greeting, Gradle!")
    }
}

tasks.register<GreetingTask>("myGreet") {
    greeting = "Hi"
}
```
- Используется аннотация `@TaskAction` для указания **метода, который выполняется при запуске задачи**.
- Позволяет создавать **повторно используемые задачи с настраиваемыми параметрами**.
## 4️⃣ Преимущества кастомных задач в Gradle
1. Полная интеграция с **графом задач Gradle** (можно задавать `dependsOn`).
2. Поддержка **ленивой конфигурации** (`tasks.register`) для ускорения сборки.
3. Возможность создавать **переиспользуемые и типизированные задачи** через Groovy/Kotlin классы.
4. Лёгкое использование **вложенных действий, циклов и условий** — гибкость, которой нет в Maven.