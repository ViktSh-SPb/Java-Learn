–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Hibernate.initialize()` ‚Äî —ç—Ç–æ **–æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –ø—Ä—è–º—ã—Ö –∏ –ø–æ–Ω—è—Ç–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤** –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å `LazyInitializationException`,  –µ—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å `fetch = LAZY`, –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ–¥–≥—Ä—É–∂–µ–Ω—ã **–≤–Ω—É—Ç—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏**.
## ‚öôÔ∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `Hibernate.initialize()`
–ú–µ—Ç–æ–¥ `Hibernate.initialize(Object proxy)`  
—è–≤–Ω–æ **–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ª–µ–Ω–∏–≤—ã–π –ø—Ä–æ–∫—Å–∏ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏—é**,  
–µ—Å–ª–∏ –æ–Ω–∞ –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏.
üìò –ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è:
> `Hibernate.initialize()` –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç Hibernate –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL-–∑–∞–ø—Ä–æ—Å  
> –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ª–µ–Ω–∏–≤–æ–µ –ø–æ–ª–µ, –ø–æ–∫–∞ —Å–µ—Å—Å–∏—è –µ—â—ë –æ—Ç–∫—Ä—ã—Ç–∞.
### üîπ –ü—Ä–∏–º–µ—Ä 1. –õ–µ–Ω–∏–≤–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è (`@OneToMany`)
```java
@Transactional
public Author getAuthor(Long id) {
    Author author = authorRepository.findById(id)
            .orElseThrow();
    // –ó–¥–µ—Å—å books ‚Äî –ª–µ–Ω–∏–≤–æ–µ –ø–æ–ª–µ (fetch = LAZY)
    Hibernate.initialize(author.getBooks()); // üí° –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–≥—Ä—É–∂–∞–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏—é
    return author;
}
```
üìà –ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ `Hibernate.initialize()` Hibernate –≤—ã–ø–æ–ª–Ω–∏—Ç:
```sql
SELECT * FROM books WHERE author_id = ?
```
–∏ –∫–æ–ª–ª–µ–∫—Ü–∏—è `author.getBooks()` –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ **–¥–∞–∂–µ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**.
### üîπ –ü—Ä–∏–º–µ—Ä 2. –õ–µ–Ω–∏–≤–æ–µ –ø–æ–ª–µ (`@ManyToOne`, `@OneToOne`)
```java
@Transactional
public Book getBook(Long id) {
    Book book = bookRepository.findById(id).orElseThrow();
    Hibernate.initialize(book.getAuthor()); // üí° –ø–æ–¥–≥—Ä—É–∂–∞–µ–º –∞–≤—Ç–æ—Ä–∞
    return book;
}
```
### üîπ –ü—Ä–∏–º–µ—Ä 3. –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
–ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å `PersistenceUnitUtil.isLoaded()`:
```java
@Transactional
public Author getAuthorSafe(Long id) {
    Author author = authorRepository.findById(id).orElseThrow();
    if (!entityManager.getEntityManagerFactory().getPersistenceUnitUtil()
            .isLoaded(author.getBooks())) {
        Hibernate.initialize(author.getBooks());
    }
    return author;
}
```
## üìò –ö–∞–∫ —ç—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–æ—Ç–∏–≤ `LazyInitializationException`
–¢–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:
- –º–µ—Ç–æ–¥ —Å–µ—Ä–≤–∏—Å–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—É—â–Ω–æ—Å—Ç—å;
- —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è;
- –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø—ã—Ç–∞–µ—Ç—Å—è —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–µ–Ω–∏–≤–æ–µ –ø–æ–ª–µ ‚Üí üí• `LazyInitializationException`.
–ò—Å–ø–æ–ª—å–∑—É—è `Hibernate.initialize()` **–≤–Ω—É—Ç—Ä–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**,  
—Ç—ã –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–¥–≥—Ä—É–∂–∞–µ—à—å –ø–æ–ª–µ, –∏ Hibernate –Ω–µ –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –±–∞–∑–µ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–µ—Å—Å–∏–∏.
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, JSON —á–µ—Ä–µ–∑ Jackson) **–±–µ–∑–æ–ø–∞—Å–Ω–∞**.
### üîπ –ü—Ä–∏–º–µ—Ä –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Spring Boot:
```java
@Service
@RequiredArgsConstructor
public class AuthorService {
    private final AuthorRepository authorRepository;

    @Transactional
    public Author getAuthorWithBooks(Long id) {
        Author author = authorRepository.findById(id)
                .orElseThrow();
        Hibernate.initialize(author.getBooks()); // ‚úÖ —Ä–µ—à–∞–µ–º –ø—Ä–æ–±–ª–µ–º—É
        return author;
    }
}
```
```java
@RestController
@RequiredArgsConstructor
public class AuthorController {
    private final AuthorService authorService;

    @GetMapping("/authors/{id}")
    public Author getAuthor(@PathVariable Long id) {
        return authorService.getAuthorWithBooks(id);
    }
}
```
‚û°Ô∏è –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ `author.getBooks()` –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ,  
–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ JSON –Ω–µ –≤—ã–∑–æ–≤–µ—Ç `LazyInitializationException`.
## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã

|–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å|–û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|
|üî∏ –†–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–π Hibernate-—Å–µ—Å—Å–∏–∏**|–ü–æ—ç—Ç–æ–º—É –º–µ—Ç–æ–¥, –≥–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `Hibernate.initialize()`, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω `@Transactional`.|
|üî∏ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫ –∫–æ–ª–ª–µ–∫—Ü–∏–∏, —Ç–∞–∫ –∏ –æ–¥–∏–Ω–æ—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏|–ú–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –¥–ª—è `@ManyToOne`, `@OneToOne`, `@OneToMany`, `@ManyToMany`.|
|üî∏ –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∑–∞–≥—Ä—É–∑–∫–∏|`fetch = LAZY` –æ—Å—Ç–∞—ë—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º, –ø—Ä–æ—Å—Ç–æ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–º–µ–Ω—Ç.|
|üî∏ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç Hibernate API|–≠—Ç–æ **–Ω–µ —á–∞—Å—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ JPA**, –ø–æ—ç—Ç–æ–º—É –∫–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è Hibernate-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º.|
|üî∏ –ù–µ —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–≤—Å–µ–º–µ—Å—Ç–Ω–æ|–õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `JOIN FETCH` –∏–ª–∏ `@EntityGraph` –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤, –≥–¥–µ –Ω—É–∂–Ω–∞ –ø–æ–¥–≥—Ä—É–∑–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.|
## ‚úÖ –ö–æ–≥–¥–∞ `Hibernate.initialize()` ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–∏–π –≤—ã–±–æ—Ä

|–°–∏—Ç—É–∞—Ü–∏—è|–ü–æ—á–µ–º—É –ø–æ–¥—Ö–æ–¥–∏—Ç|
|---|---|
|–ù—É–∂–Ω–æ –ø–æ–¥–≥—Ä—É–∑–∏—Ç—å –ª–µ–Ω–∏–≤—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ —Å–µ—Ä–≤–∏—Å–∞|–ü—Ä–æ—Å—Ç–æ–µ –∏ —Ç–æ—á–µ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ|
|–ù–µ —Ö–æ—á–µ—Ç—Å—è –º–µ–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å (–æ—Å—Ç–∞–≤–∏—Ç—å `findById`)|–ú–æ–∂–Ω–æ –ø–æ–¥–≥—Ä—É–∑–∏—Ç—å –≤—Ä—É—á–Ω—É—é|
|–ù—É–∂–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ JSON –Ω–µ —É–ø–∞–¥—ë—Ç|–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –æ–±—ä–µ–∫—Ç–∞|
|–†–∞–±–æ—Ç–∞–µ—à—å —Å Hibernate –Ω–∞–ø—Ä—è–º—É—é, –Ω–µ —á–∏—Å—Ç–æ–π JPA|–î–æ–ø—É—Å—Ç–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å|
## üö´ –ö–æ–≥–¥–∞ **–ª—É—á—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**

|–°–∏—Ç—É–∞—Ü–∏—è|–õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å|
|---|---|
|–ù—É–∂–Ω–∞ –≤—ã–±–æ—Ä–∫–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–¥–≥—Ä—É–∑–∫–∞–º–∏|`JOIN FETCH`|
|–í—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —á–µ—Ä–µ–∑ REST API|DTO / –ø—Ä–æ–µ–∫—Ü–∏–∏|
|–•–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É JPA-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏|`@EntityGraph`|
|–ù–∞–¥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–Ω–æ–≥–æ –∫–æ–ª–ª–µ–∫—Ü–∏–π|–°–æ—Å—Ç–∞–≤–Ω–æ–π –∑–∞–ø—Ä–æ—Å (batch fetch / join fetch)|
## üí° –†–µ–∑—é–º–µ

|–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç|–°—É—Ç—å|
|---|---|
|–ß—Ç–æ –¥–µ–ª–∞–µ—Ç|–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –ª–µ–Ω–∏–≤–æ–µ –ø–æ–ª–µ –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏|
|–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å|–í–Ω—É—Ç—Ä–∏ `@Transactional` –º–µ—Ç–æ–¥–æ–≤, –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º —Å—É—â–Ω–æ—Å—Ç–∏|
|–ö–∞–∫ –ø–æ–º–æ–≥–∞–µ—Ç|–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç `LazyInitializationException` –ø—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –¥–æ—Å—Ç—É–ø–µ –ø–æ—Å–ª–µ —Å–µ—Å—Å–∏–∏|
|–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞|`JOIN FETCH`, `@EntityGraph`, DTO|
