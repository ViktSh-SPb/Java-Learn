## üß© –ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –≤ Kafka
**–†–µ–ø–ª–∏–∫–∞—Ü–∏—è** ‚Äî —ç—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ **–∫–æ–ø–∏–π –ø–∞—Ä—Ç–∏—Ü–∏–π —Ç–æ–ø–∏–∫–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±—Ä–æ–∫–µ—Ä–∞—Ö**.
- –ö–∞–∂–¥–∞—è –ø–∞—Ä—Ç–∏—Ü–∏—è –∏–º–µ–µ—Ç:
    - **Leader** ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–ø–∏—è, –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è –∑–∞–ø–∏—Å–∏ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞—é—â–∞—è —á—Ç–µ–Ω–∏–µ;
    - **Follower(s)** ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∫–æ–ø–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç –¥–∞–Ω–Ω—ã–µ –ª–∏–¥–µ—Ä–∞.
> –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ **–¥–∞–Ω–Ω—ã–µ –Ω–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã**, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ –±—Ä–æ–∫–µ—Ä–æ–≤ –≤—ã–π–¥–µ—Ç –∏–∑ —Å—Ç—Ä–æ—è.
## üîπ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è
1. **Producer –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ**
    - –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å—Ç—É–ø–∞–µ—Ç –Ω–∞ **–ª–∏–¥–µ—Ä –ø–∞—Ä—Ç–∏—Ü–∏–∏**.
    - Leader –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–≤–æ–π –ª–æ–≥.
2. **Leader —Ä–µ–ø–ª–∏—Ü–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ followers**
    - –í—Å–µ followers —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç –ª–æ–≥ —Å –ª–∏–¥–µ—Ä–æ–º.
    - –ü–æ–∫–∞ follower –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω, –æ–Ω –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è —á–∞—Å—Ç—å—é **ISR (in-sync replicas)**.
3. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (acks)**
    - –ï—Å–ª–∏ `acks=all`, –ø—Ä–æ–¥—é—Å–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ **–≤—Å–µ —Ä–µ–ø–ª–∏–∫–∏ –≤ ISR** –ø–æ–ª—É—á–∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ.
    - –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **–Ω–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**.
4. **Failover**
    - –ï—Å–ª–∏ –ª–∏–¥–µ—Ä –ø–∞–¥–∞–µ—Ç:
        - –û–¥–∏–Ω –∏–∑ **—Ñ–æ–ª–ª–æ–≤–µ—Ä–æ–≤ –∏–∑ ISR** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º –ª–∏–¥–µ—Ä–æ–º.
        - –ü—Ä–æ–¥—é—Å–µ—Ä—ã –∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ –Ω–æ–≤–æ–≥–æ –ª–∏–¥–µ—Ä–∞.
## üîπ –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è
1. **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**
    - –î–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å—Ç—Ä–æ—è –±—Ä–æ–∫–µ—Ä–∞.
    - –ö–ª–∞—Å—Ç–µ—Ä –æ—Å—Ç–∞—ë—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ–µ –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É–∑–ª–æ–≤.
2. **–ì–∞—Ä–∞–Ω—Ç–∏—è –Ω–∞–¥–µ–∂–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏**
    - –ü—Ä–æ–¥—é—Å–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å —É–≤–µ—Ä–µ–Ω, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É–∑–ª–∞—Ö (–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ `acks=all`).
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á—Ç–µ–Ω–∏—è**
    - –†–µ–ø–ª–∏–∫–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å —Ä–∞–∑–Ω—ã—Ö –±—Ä–æ–∫–µ—Ä–æ–≤ (—á–µ—Ä–µ–∑ follower fetch), —É–º–µ–Ω—å—à–∞—è –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ª–∏–¥–µ—Ä–∞.
4. **–í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**
    - –ö–ª–∞—Å—Ç–µ—Ä –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –ø–æ–∫–∞ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Ä–µ–ø–ª–∏–∫–∞ –∏–∑ ISR.
## üîπ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏
- **Replication factor** ‚Äî —á–∏—Å–ª–æ –∫–æ–ø–∏–π –ø–∞—Ä—Ç–∏—Ü–∏–∏:
    - –ù–∞–ø—Ä–∏–º–µ—Ä, `replication.factor=3` ‚Üí –æ–¥–Ω–∞ –∫–æ–ø–∏—è –ª–∏–¥–µ—Ä–∞ + –¥–≤–µ —Ä–µ–ø–ª–∏–∫–∏.
- **ISR (in-sync replicas)** ‚Äî —Å–ø–∏—Å–æ–∫ —Ä–µ–ø–ª–∏–∫, –∫–æ—Ç–æ—Ä—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å –ª–∏–¥–µ—Ä–æ–º:
    - –¢–æ–ª—å–∫–æ –æ–Ω–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è—Ö `acks=all`.
üìå _–í–∞–∂–Ω–æ:_ –ï—Å–ª–∏ –≤—Å–µ —Ä–µ–ø–ª–∏–∫–∏ –ø–∞–¥–∞—é—Ç ‚Äî –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è, –ø–æ—ç—Ç–æ–º—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–º–µ—Ç—å `replication.factor >= 3`.
## üîπ –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏
```
Producer ‚Üí Leader (Partition 0) ‚îÄ‚îÄ> Follower 1 (replica)
                                 ‚îî‚îÄ> Follower 2 (replica)

–ï—Å–ª–∏ –ª–∏–¥–µ—Ä –ø–∞–¥–∞–µ—Ç ‚Üí Follower 1 —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º –ª–∏–¥–µ—Ä–æ–º
```
- –°–æ–æ–±—â–µ–Ω–∏–µ –ø–∏—à–µ—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞ –≤ –ª–∏–¥–µ—Ä–∞, –ø–æ—Ç–æ–º —Ä–µ–ø–ª–∏—Ü–∏—Ä—É–µ—Ç—Å—è –Ω–∞ followers.
- –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ —á–∏—Ç–∞—é—Ç –ª–∏–±–æ —Å –ª–∏–¥–µ—Ä–∞, –ª–∏–±–æ —Å follower (–≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö).
## üß† –ò—Ç–æ–≥
**–†–µ–ø–ª–∏–∫–∞—Ü–∏—è –≤ Kafka** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–∞–∂–µ –ø—Ä–∏ —Å–±–æ—è—Ö –±—Ä–æ–∫–µ—Ä–æ–≤;
- **–í—ã—Å–æ–∫—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å** ‚Äî —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —É–∑–ª–æ–≤;
- **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á—Ç–µ–Ω–∏—è** ‚Äî –º–æ–∂–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –º–µ–∂–¥—É —Ä–µ–ø–ª–∏–∫–∞–º–∏.
> –ë–µ–∑ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ Kafka –Ω–µ –±—ã–ª–∞ –±—ã –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–π –∏ –Ω–µ —Å–º–æ–≥–ª–∞ –±—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–∏–ª–ª–∏–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏.