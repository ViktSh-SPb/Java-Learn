# ‚úÖ 1. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ HttpSecurity (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–±)
–í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Spring Security:
```java
@Bean
public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
    return http
            .csrf(csrf -> csrf.disable())
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/admin/**").hasRole("ADMIN")     // —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω
                .requestMatchers("/user/**").hasAnyRole("USER", "ADMIN")
                .requestMatchers("/public/**").permitAll()         // –¥–æ—Å—Ç—É–ø –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                .anyRequest().authenticated()                     // –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî —Ç—Ä–µ–±—É–µ—Ç –≤—Ö–æ–¥–∞
            )
            .build();
}
```
### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
- `permitAll()` ‚Äî –¥–æ—Å—Ç—É–ø –≤—Å–µ–º
- `authenticated()` ‚Äî —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ
- `hasRole("ADMIN")`
- `hasAnyRole("USER", "ADMIN")`
- `hasAuthority("SCOPE_read")` ‚Äî –¥–ª—è OAuth/JWT
- `denyAll()` ‚Äî –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é
# ‚úÖ 2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–µ—Ç–æ–¥–æ–≤ (@PreAuthorize)
–ú–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å:
```java
@EnableMethodSecurity
@Configuration
public class SecurityConfig {}
```
–ü—Ä–∏–º–µ—Ä—ã:
```java
@PreAuthorize("hasRole('ADMIN')")
@GetMapping("/admin")
public String adminData() { ... }

@PreAuthorize("hasAnyAuthority('READ_PRIVILEGE', 'WRITE_PRIVILEGE')")
public void update() { ... }

@PreAuthorize("isAuthenticated()")
public void onlyAuth() { ... }
```
–ü–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ —É –æ–¥–Ω–æ–≥–æ URL –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏–ª–∏ —Å–ª–æ–∂–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞.
# ‚úÖ 3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é WebSecurityCustomizer (–¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤)
–ú–æ–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å URL –∏–∑ Security –≤–æ–æ–±—â–µ:
```java
@Bean
public WebSecurityCustomizer webSecurityCustomizer() {
    return web -> web.ignoring()
            .requestMatchers("/css/**", "/js/**", "/images/**");
}
```
# ‚úÖ 4. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ —Ñ–∏–ª—å—Ç—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ JWT)
–ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–æ–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –≤ —Ñ–∏–ª—å—Ç—Ä–µ:
```java
if (userDetails.getAuthorities().stream()
        .noneMatch(a -> a.getAuthority().equals("ROLE_ADMIN"))) {
    response.setStatus(HttpServletResponse.SC_FORBIDDEN);
    return;
}
```
–ù–æ —Ç–∞–∫ –ª—É—á—à–µ –¥–µ–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö ‚Äî —ç—Ç–æ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ.
# üî• –°–∞–º—ã–µ —á–∞—Å—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
### üîí –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º:
```java
.requestMatchers("/api/admin/**").hasRole("ADMIN")
```
### üë§ –†–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º:
```java
.requestMatchers("/profile/**").authenticated()
```
### üåç –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø:
```java
.requestMatchers("/auth/**", "/docs/**").permitAll()
```
### ‚õî –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å URL:
```java
.requestMatchers("/forbidden/**").denyAll()
```
# üß© –í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å
1. **hasRole("ADMIN") –æ–∑–Ω–∞—á–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ authority "ROLE_ADMIN".**
2. –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–∞–≤–∏–ª –≤–∞–∂–µ–Ω ‚Äî Spring Security –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Ö —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑.
3. –î–ª—è JWT —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è:
    - —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω;
    - HttpSecurity –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª–∏.